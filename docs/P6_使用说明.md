# P6 前端可视化使用说明

## 🚀 快速启动

### 1. 启动后端服务

```bash
# 进入后端目录
cd backend

# 启动服务器
python main.py
```

**预期输出**:
```
============================================================
AI 游戏开发公司 启动中...
============================================================
✅ 配置验证通过
...
✅ 应用启动成功
📡 API 文档: http://localhost:8000/api/docs
🌐 前端界面: http://localhost:8000/
============================================================
```

### 2. 打开前端界面

在浏览器中访问: **http://localhost:8000/**

推荐使用：
- ✅ Google Chrome
- ✅ Microsoft Edge
- ✅ Firefox

### 3. 验证功能

**检查清单**:

- [ ] 页面加载成功，看到标题"AI游戏公司 - 虚拟办公室"
- [ ] 右上角显示"已连接"（绿色）
- [ ] 左侧看到"虚拟办公室"面板，显示5个Agent卡片
- [ ] 左下方看到"实时对话"面板
- [ ] 右上方看到"项目状态"面板
- [ ] 右下方看到"项目文件"面板
- [ ] 界面布局合理，无错位或遮挡

---

## 🎮 功能演示

### 创建测试项目（可选）

如果想看到实时数据，可以通过API创建测试项目：

```bash
# 使用curl或Postman发送请求
curl -X POST http://localhost:8000/api/project/start \
  -H "Content-Type: application/json" \
  -d '{
    "name": "test_game",
    "description": "制作一个简单的贪吃蛇游戏"
  }'
```

### 查看效果

创建项目后，前端应该自动显示：
- ✅ 项目名称更新为"test_game"
- ✅ 开发阶段显示当前阶段
- ✅ Agent状态变化（从"空闲"变为"工作中"）
- ✅ 实时对话面板显示Agent之间的消息
- ✅ 文件浏览器显示生成的文件

---

## 🔧 常见问题

### 1. 页面打不开？

**检查**:
- 后端服务是否启动成功？
- 端口8000是否被占用？
- 防火墙是否阻止访问？

**解决**:
```bash
# 检查端口占用
netstat -ano | findstr :8000

# 如果端口被占用，修改 .env 文件中的 SERVER_PORT
```

### 2. 显示"未连接"？

**原因**: WebSocket连接失败

**检查**:
- F12打开浏览器控制台，查看错误信息
- 后端服务是否正常运行？
- 网络是否正常？

**解决**:
- 刷新页面
- 重启后端服务
- 检查防火墙设置

### 3. Agent卡片不显示？

**原因**: JavaScript加载失败

**检查**:
- F12打开控制台，查看是否有错误
- 检查 `frontend/js/` 目录下的文件是否完整

**解决**:
```bash
# 验证前端文件
python test_p6_frontend.py
```

### 4. 界面显示错乱？

**原因**: CSS文件加载失败或浏览器兼容性问题

**解决**:
- 清除浏览器缓存
- 使用Chrome或Edge浏览器
- 检查 `frontend/css/style.css` 文件是否存在

---

## 🎨 界面说明

### 顶部标题栏
- **左侧**: 应用标题和Logo
- **右侧**: WebSocket连接状态指示器
  - 绿色"已连接": 正常
  - 红色"未连接": 断线（会自动重连）

### 左侧面板

#### 虚拟办公室
- 显示5个Agent卡片
- 每个卡片包含：
  - 头像emoji
  - Agent名称和ID
  - 当前状态徽章（空闲/思考中/工作中）

#### 实时对话
- 显示Agent之间的实时消息
- 消息格式：发送者 → 接收者
- 时间戳显示在右侧
- 自动滚动到最新消息

### 右侧面板

#### 项目状态
- **当前项目**: 项目名称
- **开发阶段**: 当前所处阶段（中文）
- **进度**: 进度条和百分比
- **Agent工作状态**: 5个Agent的实时状态

#### 项目文件
- 树形文件结构
- 点击文件夹可展开/折叠
- 显示文件图标（📁文件夹 📄文件）

---

## 📊 监控和调试

### 浏览器控制台

按F12打开开发者工具，查看：

**Console标签页**:
```
📡 正在连接WebSocket: ws://localhost:8000/ws/...
✅ WebSocket连接成功
📦 所有模块已初始化
📨 收到消息: {event: "agent_message", ...}
```

**Network标签页**:
- 检查WebSocket连接（ws://localhost:8000/ws/...）
- 查看HTTP请求（/api/projects, /api/project/xxx/status）

---

## 🔍 下一步

### 测试完成后

如果前端界面正常工作，您可以：

1. **进入P7阶段**: 开发人类介入机制（老板决策面板）
2. **完善功能**: 添加更多交互功能
3. **优化UI**: 美化界面，提升用户体验

### 准备P7开发

阅读文档:
- `docs/stage_guides/P7_指引.md` - P7阶段开发指引
- `docs/platform_constitution.md` - 查看P6完成记录

---

## 📞 技术支持

### 相关文档
- `docs/P6_阶段完成报告.md` - 详细技术报告
- `docs/platform_constitution.md` - P6章节
- `docs/stage_guides/P6_指引.md` - 开发指引

### 测试脚本
- `test_p6_frontend.py` - 前端结构测试
- `tests/run_regression.py` - 回归测试

---

**文档版本**: v1.0  
**最后更新**: 2026-02-11  
**适用阶段**: P6 - 前端可视化
