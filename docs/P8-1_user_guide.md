# P8-1 阶段：2D像素风办公室使用指南

## 🎉 新功能介绍

P8-1阶段为AI游戏公司平台添加了令人兴奋的实时可视化功能！现在您可以：

- 👀 **实时观看** 5个AI Agent在虚拟办公室中的工作状态
- 💬 **看到对话** Agent之间的消息以飞行动画和气泡形式显示
- 📊 **监控进度** 项目开发进度、当前阶段、Agent状态
- 🎮 **观赏过程** 游戏制作从头到尾的全过程可视化

## 🚀 快速开始

### 1. 启动后端服务器

```bash
# 在项目根目录
python backend/main.py
```

等待看到：
```
✅ 应用启动成功
📡 API 文档: http://localhost:8000/api/docs
🌐 前端界面: http://localhost:8000/
```

### 2. 打开前端界面

在浏览器中访问：**http://localhost:8000/**

您将看到：
- 顶部：紫色渐变标题栏 + 创建项目按钮 + 连接状态
- 左侧上方：**2D像素风办公室**（深蓝色背景的Pixi.js Canvas）
- 左侧下方：实时对话窗口
- 右侧：项目状态面板 + Agent状态列表 + 文件浏览器

### 3. 创建测试项目

1. 点击右上角 **"➕ 创建新项目"** 按钮
2. 填写项目信息：
   - **项目名称**：`test_office` 或任意名称
   - **游戏描述**：选择模板（贪吃蛇/Flappy Bird等）或自定义
3. 点击 **"🚀 开始制作"**

### 4. 观察魔法发生！

项目创建后，立即在办公室场景中观看：

#### 👨‍💼 Agent动起来了！
- 5个Agent精灵出现在各自工位：
  - 👨‍💼 PM（左上）
  - 📋 策划（右上）
  - 👨‍💻 程序员（左下）
  - 🎨 美术（右下）
  - 🧪 测试（中下）

#### 🎨 状态颜色变化
注意每个Agent头上的彩色圆圈：
- **灰色** = 空闲中
- **蓝色** = 工作中
- **绿色** = 正在交流
- **橙色** = 思考中
- **红色** = 遇到错误

#### ✈️ 消息飞行动画
当Agent之间交流时：
1. 橙色小球从发送者飞向接收者
2. 飞行路径是平滑的弧线（贝塞尔曲线）
3. 小球旋转并缩放
4. 到达后接收者头顶显示白色对话气泡
5. 气泡3秒后自动消失

#### 💬 实时对话记录
左下角的对话窗口实时显示：
- 谁发送消息（发送者Emoji + 名称）
- 发送给谁
- 消息内容
- 时间戳

#### 📊 项目进度追踪
右侧面板显示：
- 当前项目名称
- 开发阶段（策划/开发/测试/交付）
- 进度百分比
- 每个Agent的当前任务

## 🎯 功能亮点

### 1. 基于Pixi.js的WebGL渲染
- **高性能**：60fps流畅动画
- **硬件加速**：利用GPU渲染
- **跨平台**：所有现代浏览器都支持

### 2. 实时WebSocket同步
- **零延迟**：< 100ms响应时间
- **双向通信**：后端推送 + 前端订阅
- **自动重连**：网络断开自动恢复

### 3. 贝塞尔曲线动画
- **视觉流畅**：弧线比直线更自然
- **缓动效果**：ease-in-out加减速
- **动态效果**：旋转 + 缩放 + 路径

### 4. 模块化架构
```
frontend/js/
├── office_scene.js      # 办公室场景管理
├── agent_sprite.js      # Agent精灵系统
├── message_bubble.js    # 消息动画系统
├── app.js               # 主应用协调
├── websocket.js         # WebSocket客户端
├── chat_panel.js        # 聊天面板
└── status_panel.js      # 状态面板
```

## 📖 使用技巧

### 观察Agent工作流程
1. **项目启动**：PM首先发言，制定计划
2. **策划阶段**：策划Agent撰写GDD（游戏设计文档）
3. **并行开发**：程序员和美术同时工作
4. **测试验证**：测试Agent运行并报告Bug
5. **Bug修复**：程序员修复问题
6. **最终交付**：PM汇总成果

### 快速定位问题
- **红色状态圆圈**：Agent遇到错误，检查聊天记录
- **长时间蓝色**：Agent可能在等待LLM响应
- **突然停止**：可能达到Token限制或API错误

### 性能优化
- 建议使用Chrome或Edge浏览器（最佳WebGL支持）
- 多个项目时关闭不活跃的标签页
- F12开发者工具的Performance标签可监控性能

## 🐛 常见问题

### Q: 办公室场景显示"正在加载..."
**A**: Pixi.js正在从CDN加载，稍等几秒。如果长时间未加载，检查网络连接。

### Q: WebSocket显示"未连接"
**A**: 
1. 确认后端服务器正在运行（http://localhost:8000）
2. 检查浏览器控制台是否有错误
3. 尝试刷新页面

### Q: Agent不动了
**A**: 
1. 检查是否遇到API错误（右侧状态面板）
2. 查看后端终端日志
3. 可能是等待人类决策（P7功能）

### Q: 消息动画太快/太慢
**A**: 当前飞行时间固定为1秒，P8-2阶段将支持自定义速度。

### Q: 能否隐藏某些Agent？
**A**: 当前P8-1不支持，P8-2将添加交互功能（点击Agent查看详情/隐藏）。

## 🔮 P8-2预告

下一阶段（P8-2）将带来更多增强功能：

### 即将到来
- ✨ **真正的像素风精灵图**：替代Emoji，更精致
- 🚶 **Agent走动动画**：Agent在办公室中移动
- 🪑 **办公室装饰**：桌子、电脑、植物、书架
- 🖱️ **点击交互**：点击Agent查看详情、任务列表
- 🎮 **游戏展示区**：实时预览生成的游戏
- ⚡ **更多特效**：打字动画、状态切换粒子

### 技术升级
- Sprite动画系统
- 对象池优化性能
- 音效系统
- 更丰富的交互

## 📚 相关文档

- **开发指引**: `docs/stage_guides/P8-1_指引.md`
- **完成报告**: `docs/P8-1_completion_report.md`
- **测试报告**: `docs/P8-1_test_report.md`
- **平台架构**: `docs/platform_constitution.md`

## 💡 反馈建议

如果您在使用过程中遇到问题或有改进建议，请：
1. 检查浏览器控制台（F12）的错误信息
2. 查看后端终端日志
3. 记录重现步骤

## 🎊 享受观看AI团队工作的乐趣！

现在，您不仅可以让AI制作游戏，还能**亲眼看到**他们是如何协作完成的。这就是P8-1阶段的魔力！

---

**版本**: P8-1 v1.0  
**更新日期**: 2026-02-12  
**作者**: AI Development Team
