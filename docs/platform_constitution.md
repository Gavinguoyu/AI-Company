# å¹³å°å¼€å‘å®ªæ³•

> **æœ¬æ–‡æ¡£çš„ä½œç”¨**: è®°å½•å¼€å‘æœ¬AIæ¸¸æˆå…¬å¸å¹³å°è¿‡ç¨‹ä¸­**å·²å®Œæˆ**çš„å…³é”®æ¶æ„å’Œä»£ç å®ç°  
> **ç›®æ ‡**: é˜²æ­¢Cursorå¯¹è¯åˆ‡æ¢æ—¶ä¸Šä¸‹æ–‡ä¸¢å¤±,é¿å…é—å¿˜å·²å®ç°çš„åŠŸèƒ½,æœç»é‡å¤å¼€å‘  
> **åˆ›å»ºæ—¥æœŸ**: 2026-02-11

---

## ğŸ“– AIä½¿ç”¨æŒ‡å—

### å½“ä½ è¯»åˆ°è¿™ä¸ªæ–‡æ¡£æ—¶,ä½ éœ€è¦:

**æœ¬æ–‡æ¡£æ˜¯"è®°å¿†åº“",ä¸æ˜¯"è®¡åˆ’ä¹¦":**
- âœ… æŸ¥çœ‹å·²å®Œæˆçš„é˜¶æ®µ,äº†è§£å·²å®ç°çš„æ ¸å¿ƒç±»å’Œæ–¹æ³•
- âœ… æŸ¥æ‰¾å·²å®šä¹‰çš„æ¥å£ç­¾å,ç¡®ä¿é›†æˆæ—¶è°ƒç”¨æ­£ç¡®
- âœ… æ£€æŸ¥å·²ç¡®ç«‹çš„æ¶æ„çº¦æŸ,é¿å…è¿åè®¾è®¡åŸåˆ™
- âœ… ç¡®è®¤åŠŸèƒ½æ˜¯å¦å·²å®ç°,é¿å…é‡å¤å¼€å‘
- âŒ **ä¸è¦**åœ¨è¿™é‡ŒæŸ¥æ‰¾"å¦‚ä½•å®ç°"çš„è¯¦ç»†æŒ‡å¯¼ â†’ åº”è¯¥å»è¯»`å¼€å‘è®¡åˆ’.md`
- âŒ **ä¸è¦**æœŸæœ›è¿™é‡Œæœ‰å®Œæ•´çš„ä»£ç  â†’ è¿™é‡Œåªè®°å½•å…³é”®ä¿¡æ¯

### ä½¿ç”¨åœºæ™¯:

| åœºæ™¯ | åº”è¯¥è¯»ä»€ä¹ˆ |
|------|-----------|
| å¼€å§‹æ–°é˜¶æ®µå¼€å‘ | `å¼€å‘è®¡åˆ’.md`(äº†è§£è¦åšä»€ä¹ˆ) + `æœ¬æ–‡æ¡£`(äº†è§£å·²æœ‰ä»€ä¹ˆ) |
| è°ƒè¯•é›†æˆé—®é¢˜ | `æœ¬æ–‡æ¡£`(æŸ¥æ‰¾å·²å®ç°çš„æ¥å£) |
| ä¸ç¡®å®šåŠŸèƒ½æ˜¯å¦å·²å®ç° | `æœ¬æ–‡æ¡£`(æ£€æŸ¥é¡¹ç›®çŠ¶æ€æ€»è§ˆ) |

### é˜¶æ®µå®Œæˆåçš„æ›´æ–°è§„åˆ™:

**æ¯ä¸ªPé˜¶æ®µå®Œæˆå,AIå¿…é¡»æ›´æ–°æœ¬æ–‡æ¡£:**
1. ä¿®æ”¹"é¡¹ç›®çŠ¶æ€æ€»è§ˆ"ä¸­çš„çŠ¶æ€ä¸ºâœ…
2. åœ¨å¯¹åº”çš„Pé˜¶æ®µç« èŠ‚ä¸­è®°å½•:
   - å®ç°çš„æ ¸å¿ƒç±»åå’ŒèŒè´£
   - å…³é”®æ–¹æ³•ç­¾å(ä¸è¦ç²˜è´´å®Œæ•´ä»£ç )
   - é‡è¦çš„æ¶æ„å†³ç­–å’ŒåŸå› 
   - ä¸‹ä¸€é˜¶æ®µéœ€è¦çŸ¥é“çš„æ¥å£
3. åˆ é™¤"å¾…å®ç°"å­—æ ·,æ”¹ä¸º"å·²å®ç°"
4. åªè®°å½•å…³é”®ä¿¡æ¯,æ§åˆ¶åœ¨30-80è¡Œå†…

---

## ğŸ—ï¸ æ ¸å¿ƒæ¶æ„åŸåˆ™

> è¿™äº›åŸåˆ™åœ¨é¡¹ç›®åˆæœŸç¡®ç«‹,æ‰€æœ‰é˜¶æ®µçš„å¼€å‘éƒ½å¿…é¡»éµå®ˆ

### 1. æ¶ˆæ¯é©±åŠ¨æ¶æ„
- æ‰€æœ‰Agenté€šä¿¡**å¿…é¡»**é€šè¿‡æ¶ˆæ¯æ€»çº¿
- ç¦æ­¢Agentä¹‹é—´ç›´æ¥è°ƒç”¨æ–¹æ³•
- ç»Ÿä¸€æ¶ˆæ¯æ ¼å¼(è§ä¸‹æ–¹"æ¶ˆæ¯æ ¼å¼æ ‡å‡†")

### 2. æ–‡ä»¶å³çœŸç›¸
- Agentçš„LLMä¸Šä¸‹æ–‡ä¸å¯ä¿¡,æ–‡ä»¶æ‰æ˜¯å”¯ä¸€äº‹å®æ¥æº
- æ‰€æœ‰å…±è¯†å¿…é¡»å†™å…¥æ–‡ä»¶(YAML/MD)
- Agentå·¥ä½œå‰å¿…é¡»è¯»å–ç›¸å…³æ–‡ä»¶

### 3. æ¨¡å—åŒ–ä¸å•ä¸€èŒè´£
- æ¯ä¸ªæ–‡ä»¶ä¸è¶…è¿‡150è¡Œ
- æ¯ä¸ªç±»åªè´Ÿè´£ä¸€ä»¶äº‹

### 4. å¼‚æ­¥ä¼˜å…ˆ
- æ‰€æœ‰IOæ“ä½œä½¿ç”¨`async/await`
- Agentå·¥ä½œå¾ªç¯åŸºäº`asyncio`

### 5. ä¸Šä¸‹æ–‡ç®¡ç†
- åªæ³¨å…¥å½“å‰ä»»åŠ¡æ‰€éœ€çš„æ–‡ä»¶å†…å®¹
- åˆ©ç”¨Gemini 3 Proçš„100ä¸‡ä¸Šä¸‹æ–‡çª—å£

### 6. Pythonå¯¼å…¥è§„èŒƒï¼ˆé‡è¦ï¼ï¼‰
- **backendç›®å½•å†…çš„æ–‡ä»¶äº’ç›¸å¯¼å…¥æ—¶ï¼Œç¦æ­¢ä½¿ç”¨`from backend.xxx`**
- **æ­£ç¡®ç¤ºä¾‹**: `from utils.logger import setup_logger` âœ…
- **é”™è¯¯ç¤ºä¾‹**: `from backend.utils.logger import setup_logger` âŒ
- **åŸå› **: FastAPIä»backend/main.pyå¯åŠ¨ï¼Œbackendå·²åœ¨Pythonè·¯å¾„ä¸­
- **æ•™è®­**: P4é˜¶æ®µæœ‰4ä¸ªå·¥å…·æ–‡ä»¶ä½¿ç”¨äº†é”™è¯¯å¯¼å…¥ï¼Œåœ¨P5é›†æˆæ—¶æ‰æš´éœ²

### 7. gemini 3 pro-API
- å½“éœ€è¦ç”¨åˆ°gemini 3 pro-APIæ—¶å¯ä»¥ä½¿ç”¨ä¸‹åˆ—å¯†é’¥
- AIzaSyDwJcTPnzTQumuy9HpXK6KE2KjFmaHimsk

---

## ğŸ“Š é¡¹ç›®çŠ¶æ€æ€»è§ˆ

| é˜¶æ®µ | çŠ¶æ€ | å®Œæˆæ—¥æœŸ | å…³é”®äº§å‡º |
|------|------|---------|---------|
| **P0** | âœ… å·²å®Œæˆ | 2026-02-11 | ç¯å¢ƒæ­å»º |
| **P1** | âœ… å·²å®Œæˆ | 2026-02-11 | Agentå¼•æ“æ ¸å¿ƒ |
| **P2** | âœ… å·²å®Œæˆ | 2026-02-11 | æ¶ˆæ¯æ€»çº¿ + å¤šAgent |
| **P3** | âœ… å·²å®Œæˆ | 2026-02-11 | å·¥å…·ç³»ç»Ÿ |
| **P4** | âœ… å·²å®Œæˆ | 2026-02-11 | æ¸¸æˆå¼€å‘å·¥ä½œæµ |
| **P5** | âœ… å·²å®Œæˆ | 2026-02-11 | Webåç«¯API |
| **P6** | âœ… å·²å®Œæˆ | 2026-02-11 | å‰ç«¯å¯è§†åŒ– |
| **P6æ¸¸æˆç”Ÿæˆ** | âœ… å·²å®Œæˆ | 2026-02-12 | å®é™…æ¸¸æˆç”Ÿæˆ |
| **P7** | âœ… å·²å®Œæˆ | 2026-02-12 | äººç±»ä»‹å…¥æœºåˆ¶ |
| **P8-1** | âœ… å·²å®Œæˆ | 2026-02-12 | 2Dåƒç´ é£åŠå…¬å®¤ |
| **P8-2** | â¬œ æœªå¼€å§‹ | - | åŠå…¬å®¤å¢å¼ºåŠŸèƒ½ |
| **P9** | âœ… å·²å®Œæˆ | 2026-02-12 | ç¾æœ¯é›†æˆï¼ˆGeminiå›¾ç‰‡ç”Ÿæˆï¼‰ |
| **P10** | â¬œ æœªå¼€å§‹ | - | ä¼˜åŒ–å®Œå–„ |

---

## ğŸ“ æ¶ˆæ¯æ ¼å¼æ ‡å‡†

> åœ¨P2é˜¶æ®µç¡®ç«‹çš„é€šä¿¡åè®®,æ‰€æœ‰Agentå¿…é¡»éµå®ˆ

```json
{
    "from": "agent_id",
    "to": "target_id",
    "type": "question|answer|report|request_review",
    "content": "æ¶ˆæ¯æ­£æ–‡",
    "context": "å·¥ä½œä¸Šä¸‹æ–‡",
    "priority": "normal|urgent|blocking",
    "timestamp": "ISO8601æ—¶é—´æˆ³"
}
```

---

## ğŸ—‚ï¸ é¡¹ç›®æ–‡ä»¶ç»“æ„

> åœ¨P0é˜¶æ®µç¡®ç«‹çš„ç›®å½•ç»“æ„,æ–°å»ºæ–‡ä»¶æ—¶å¿…é¡»æ”¾åœ¨æ­£ç¡®ä½ç½®

```
backend/
â”œâ”€â”€ main.py              # FastAPIå…¥å£
â”œâ”€â”€ config.py            # å…¨å±€é…ç½®
â”œâ”€â”€ engine/              # Agentå¼•æ“æ ¸å¿ƒ
â”œâ”€â”€ agents/              # å…·ä½“Agentå®ç°
â”œâ”€â”€ tools/               # Agentå·¥å…·
â”œâ”€â”€ workflows/           # å·¥ä½œæµå®šä¹‰
â””â”€â”€ api/                 # Webæ¥å£

frontend/
â”œâ”€â”€ index.html
â”œâ”€â”€ css/
â””â”€â”€ js/                  # å‰ç«¯æ¨¡å—

projects/{project_name}/ # AIç”Ÿäº§çš„æ¸¸æˆ
â”œâ”€â”€ shared_knowledge/    # å…±äº«çŸ¥è¯†åº“
â”œâ”€â”€ output/              # æ¸¸æˆäº§å‡º
â””â”€â”€ logs/                # å¯¹è¯æ—¥å¿—
```

---

## âš™ï¸ P0: ç¯å¢ƒæ­å»º

> **çŠ¶æ€**: âœ… å·²å®Œæˆ (2026-02-11)

### Pythonç¯å¢ƒ
- **Pythonç‰ˆæœ¬**: 3.14.3 âœ…
- **æ‰€éœ€ç‰ˆæœ¬**: â‰¥3.11 
- **éªŒè¯æ–¹å¼**: `python --version`

### å…³é”®ä¾èµ–
```
fastapi>=0.110.0        # Webæ¡†æ¶
uvicorn>=0.27.0         # ASGIæœåŠ¡å™¨
websockets>=12.0        # WebSocketæ”¯æŒ
google-generativeai     # Gemini APIï¼ˆå·²å®‰è£…ï¼Œä½†æœ‰è¿ç§»è­¦å‘Šï¼‰
openai>=1.12.0          # OpenAI API
litellm>=1.30.0         # å¤šæ¨¡å‹æ”¯æŒ
pydantic>=2.6.0         # æ•°æ®éªŒè¯
python-dotenv>=1.0.0    # ç¯å¢ƒå˜é‡
pyyaml>=6.0.1           # YAMLæ”¯æŒ
aiofiles>=23.2.0        # å¼‚æ­¥æ–‡ä»¶IO
httpx>=0.27.0           # å¼‚æ­¥HTTP
Pillow>=10.2.0          # å›¾åƒå¤„ç†
```

### API Keyé…ç½®
- **é…ç½®æ–‡ä»¶**: `.env`ï¼ˆå·²åˆ›å»ºï¼‰
- **Google Gemini API Key**: å·²é…ç½® âœ…
- **é…ç½®åŠ è½½**: `backend/config.py` ä¸­çš„ `Config` ç±»
- **éªŒè¯æ–¹æ³•**: `Config.validate()` è¿”å› True

### é¡¹ç›®æ–‡ä»¶ç»“æ„
å·²åˆ›å»ºå®Œæ•´ç›®å½•ç»“æ„ï¼š
```
backend/          # Pythonåç«¯ï¼ˆå·²æœ‰åŸºç¡€æ–‡ä»¶ï¼‰
  â”œâ”€â”€ config.py   # é…ç½®ç®¡ç†ï¼ˆå·²å®ç°ï¼‰
  â”œâ”€â”€ engine/     # Agentå¼•æ“ï¼ˆç©ºï¼‰
  â”œâ”€â”€ agents/     # Agentå®ç°ï¼ˆç©ºï¼‰
  â”œâ”€â”€ tools/      # å·¥å…·ç³»ç»Ÿï¼ˆç©ºï¼‰
  â”œâ”€â”€ workflows/  # å·¥ä½œæµï¼ˆç©ºï¼‰
  â””â”€â”€ api/        # Webæ¥å£ï¼ˆç©ºï¼‰
frontend/         # å‰ç«¯ï¼ˆå·²åˆ›å»ºç›®å½•ï¼‰
  â”œâ”€â”€ css/
  â”œâ”€â”€ js/
  â””â”€â”€ assets/
projects/         # AIç”Ÿäº§çš„æ¸¸æˆï¼ˆç©ºï¼‰
docs/             # æ–‡æ¡£ï¼ˆç©ºï¼‰
.cursor/rules/    # Cursorè§„åˆ™ï¼ˆå·²æœ‰3ä¸ªè§„åˆ™æ–‡ä»¶ï¼‰
```

### éªŒè¯æµ‹è¯•
- **æµ‹è¯•è„šæœ¬**: `test_setup.py`
- **æµ‹è¯•ç»“æœ**: æ‰€æœ‰æµ‹è¯•é€šè¿‡ âœ…
  - Pythonç‰ˆæœ¬æ£€æŸ¥ âœ…
  - ä¾èµ–åŒ…å¯¼å…¥ âœ…
  - é…ç½®éªŒè¯ âœ…
  - ç›®å½•ç»“æ„ âœ…

### é‡è¦æé†’
âš ï¸ `google.generativeai` åŒ…æœ‰è¿ç§»è­¦å‘Šï¼Œå»ºè®®æœªæ¥åˆ‡æ¢åˆ° `google.genai`ï¼ˆä¸å½±å“å½“å‰ä½¿ç”¨ï¼‰

---

## ğŸ§  P1: Agentå¼•æ“æ ¸å¿ƒ

> **çŠ¶æ€**: âœ… å·²å®Œæˆ (2026-02-11)

### æ ¸å¿ƒç»„ä»¶

#### 1. LLMå®¢æˆ·ç«¯ (`engine/llm_client.py`)
**èŒè´£**: å°è£… Google Gemini API è°ƒç”¨

**å…³é”®æ¥å£**:
```python
class LLMClient:
    __init__(model_name: Optional[str] = None)
    async generate_response(messages: List[Dict], system_prompt: str) -> str
    count_tokens(text: str) -> int
    get_model_info() -> Dict[str, Any]
```

**æ¨¡å‹é€‰æ‹©**: 
- **ä¸»åŠ›æ¨¡å‹**: `gemini-2.0-flash`ï¼ˆGemini 2.0 Flashï¼‰
- **åŸå› **: 
  - å¿«é€Ÿå“åº”ï¼Œé€‚åˆå®æ—¶å¯¹è¯
  - 100ä¸‡tokenä¸Šä¸‹æ–‡çª—å£
  - æˆæœ¬ä½äº Gemini Pro
  - Googleå®˜æ–¹æ¨èçš„Agentå¼€å‘æ¨¡å‹

**ç”Ÿæˆé…ç½®**:
- temperature: 0.7ï¼ˆä¿æŒåˆ›é€ æ€§ï¼‰
- top_p: 0.95
- top_k: 40
- max_output_tokens: 8192

**å¼‚æ­¥å®ç°**: ä½¿ç”¨ `asyncio.run_in_executor` åŒ…è£…åŒæ­¥API

âš ï¸ **æŠ€æœ¯å€º**: `google.generativeai` åŒ…å·²è¢«æ ‡è®°ä¸ºå¼ƒç”¨ï¼Œæœªæ¥éœ€è¿ç§»åˆ° `google.genai`

---

#### 2. ä¸Šä¸‹æ–‡ç®¡ç†å™¨ (`engine/context_manager.py`)
**èŒè´£**: ç®¡ç†Agentçš„å¯¹è¯å†å²ï¼Œé˜²æ­¢ä¸Šä¸‹æ–‡çˆ†ç‚¸

**å…³é”®æ¥å£**:
```python
class ContextManager:
    __init__(max_tokens: int = 100000, max_messages: int = 50)
    add_message(role: str, content: str) -> None
    get_messages() -> List[Dict[str, str]]
    inject_file_content(file_path: str, content: str) -> None
    clear() -> None
    get_summary() -> Dict[str, Any]
```

**ä¸Šä¸‹æ–‡ç®¡ç†ç­–ç•¥**:
1. **åŒé‡é™åˆ¶**: 
   - Tokenæ•°é‡é™åˆ¶ï¼ˆé»˜è®¤10ä¸‡ï¼‰
   - æ¶ˆæ¯æ¡æ•°é™åˆ¶ï¼ˆé»˜è®¤50æ¡ï¼‰
2. **è‡ªåŠ¨è£å‰ª**: è¶…é™æ—¶è‡ªåŠ¨åˆ é™¤æœ€æ—©çš„æ¶ˆæ¯ï¼ˆä¿ç•™ç³»ç»Ÿæ¶ˆæ¯ï¼‰
3. **æ–‡ä»¶æ³¨å…¥**: æ”¯æŒå°†æ–‡ä»¶å†…å®¹æ³¨å…¥ä¸Šä¸‹æ–‡ï¼ˆå®ç°"æ–‡ä»¶å³çœŸç›¸"ï¼‰
4. **Tokenä¼°ç®—**: ç®€å•ä¼°ç®— 1 token â‰ˆ 4 å­—ç¬¦

**æ¯ä¸ªAgentåˆ†é…**: æ€»Tokené¢„ç®—çš„1/5ï¼ˆå³æ¯ä¸ªAgent 10ä¸‡tokensï¼‰

---

#### 3. AgentåŸºç±» (`engine/agent.py`)
**èŒè´£**: æ‰€æœ‰AIå‘˜å·¥çš„åŸºç¡€æ¡†æ¶

**å…³é”®æ¥å£**:
```python
class Agent:
    __init__(agent_id: str, role: str, system_prompt: str, model_name: Optional[str] = None)
    async think_and_respond(user_message: str) -> str
    async process_message(message: Dict[str, Any]) -> Optional[str]
    load_file_to_context(file_path: str, content: str) -> None
    get_status() -> Dict[str, Any]
    reset_context() -> None
```

**AgentçŠ¶æ€**:
- `idle`: ç©ºé—²
- `thinking`: æ€è€ƒä¸­
- `working`: å·¥ä½œä¸­
- `waiting`: ç­‰å¾…ä¸­

**æ ¸å¿ƒèƒ½åŠ›**:
1. **æ€è€ƒä¸å›å¤**: æ¥æ”¶æ¶ˆæ¯ â†’ è°ƒç”¨LLM â†’ è¿”å›å›å¤
2. **æ¶ˆæ¯å¤„ç†**: æ ¹æ®æ¶ˆæ¯ç±»å‹ï¼ˆquestion/answer/reportç­‰ï¼‰å†³å®šæ˜¯å¦å›å¤
3. **æ–‡ä»¶åŠ è½½**: å°†é¡¹ç›®è§„èŒƒã€ç­–åˆ’æ–‡æ¡£ç­‰åŠ è½½åˆ°ä¸Šä¸‹æ–‡
4. **çŠ¶æ€ç®¡ç†**: è·Ÿè¸ªAgentå½“å‰çŠ¶æ€å’Œä»»åŠ¡

**æ¶ˆæ¯ç±»å‹å¤„ç†**:
- `question`, `request_review` â†’ éœ€è¦å›å¤
- `answer`, `report` â†’ åªè®°å½•ï¼Œä¸å›å¤

---

### éªŒè¯æµ‹è¯•

**æµ‹è¯•æ–¹å¼**: åˆ›å»ºæµ‹è¯•Agentï¼Œæ¨¡æ‹Ÿå¤šè½®å¯¹è¯

**æµ‹è¯•ç»“æœ**: âœ… å…¨éƒ¨é€šè¿‡
- LLMè°ƒç”¨æˆåŠŸï¼Œå“åº”åˆç†
- ä¸Šä¸‹æ–‡ç®¡ç†æ­£å¸¸ï¼Œè‡ªåŠ¨è£å‰ªå·¥ä½œæ­£å¸¸
- Agentèƒ½è®°ä½ä¸Šä¸‹æ–‡ï¼Œè¿›è¡Œè¿è´¯å¯¹è¯
- æ–‡ä»¶æ³¨å…¥åŠŸèƒ½æ­£å¸¸

**æµ‹è¯•åœºæ™¯**:
1. åŸºæœ¬å¯¹è¯ï¼šAgentèƒ½ç†è§£æ¸¸æˆéœ€æ±‚å¹¶ç»™å‡ºå»ºè®®
2. å¤šè½®å¯¹è¯ï¼šAgentèƒ½è®°ä½ä¹‹å‰çš„å¯¹è¯å†…å®¹
3. æ–‡ä»¶æ³¨å…¥ï¼šAgentèƒ½æ ¹æ®æ³¨å…¥çš„é¡¹ç›®è§„èŒƒå›ç­”é—®é¢˜

---

### æ¶æ„å†³ç­–

**1. ä¸ºä»€ä¹ˆé€‰æ‹© Gemini 2.0 Flashï¼Ÿ**
- ç¬¦åˆå¼€å‘è®¡åˆ’è¦æ±‚ï¼ˆ100ä¸‡ä¸Šä¸‹æ–‡ï¼‰
- é€Ÿåº¦å¿«ï¼Œé€‚åˆå®æ—¶å¯¹è¯
- æˆæœ¬åˆç†ï¼ˆå¼€å‘é˜¶æ®µå¤Ÿç”¨ï¼‰

**2. ä¸ºä»€ä¹ˆä½¿ç”¨å¼‚æ­¥æ¶æ„ï¼Ÿ**
- æœªæ¥éœ€è¦æ”¯æŒå¤šä¸ªAgentå¹¶å‘å·¥ä½œ
- LLM APIè°ƒç”¨æ˜¯IOå¯†é›†å‹æ“ä½œï¼Œå¼‚æ­¥å¯æå‡æ€§èƒ½
- ç¬¦åˆå¹³å°å®ªæ³•ä¸­çš„"å¼‚æ­¥ä¼˜å…ˆ"åŸåˆ™

**3. ä¸ºä»€ä¹ˆAgentä¸ç›´æ¥è°ƒç”¨å½¼æ­¤ï¼Ÿ**
- éµå¾ª"æ¶ˆæ¯é©±åŠ¨æ¶æ„"åŸåˆ™
- æ‰€æœ‰é€šä¿¡å¿…é¡»é€šè¿‡æ¶ˆæ¯æ€»çº¿ï¼ˆP2é˜¶æ®µå®ç°ï¼‰
- Agentä¹‹é—´è§£è€¦ï¼Œä¾¿äºæ‰©å±•å’Œè°ƒè¯•

---

## ğŸ”„ P2: æ¶ˆæ¯æ€»çº¿ + å¤šAgentåä½œ

> **çŠ¶æ€**: âœ… å·²å®Œæˆ (2026-02-11)

### å‰ç½®æ”¹è¿›ä»»åŠ¡ï¼ˆâœ… å·²å®Œæˆ 2026-02-11ï¼‰

åŸºäº P1 æµ‹è¯•åé¦ˆï¼ŒP2 å¼€å§‹å‰çš„æ”¹è¿›ä»»åŠ¡å·²å…¨éƒ¨å®Œæˆï¼š

#### 1. ç»Ÿä¸€æ—¥å¿—ç³»ç»Ÿ (`utils/logger.py`) âœ…
**å®ç°å†…å®¹**:
- âœ… åˆ›å»º `backend/utils/logger.py` ç»Ÿä¸€æ—¥å¿—æ¨¡å—
- âœ… æ”¯æŒæ§åˆ¶å°è¾“å‡ºå’Œæ–‡ä»¶è¾“å‡ºï¼ˆæŒ‰æ—¥æœŸå’Œæ¨¡å—åˆ†æ–‡ä»¶ï¼‰
- âœ… æ”¯æŒæ—¥å¿—çº§åˆ«ï¼ˆDEBUG/INFO/WARNING/ERRORï¼‰
- âœ… æ›´æ–° llm_client.pyã€context_manager.pyã€agent.py é›†æˆæ—¥å¿—
- âœ… æ—¥å¿—æ ¼å¼ï¼š`æ—¶é—´ | æ¨¡å—å | çº§åˆ« | æ¶ˆæ¯`

#### 2. LLMé‡è¯•æœºåˆ¶ (`utils/retry.py`) âœ…
**å®ç°å†…å®¹**:
- âœ… åˆ›å»º `backend/utils/retry.py` é‡è¯•è£…é¥°å™¨
- âœ… å®ç°æŒ‡æ•°é€€é¿ç­–ç•¥ï¼ˆ2ç§’ â†’ 4ç§’ â†’ 8ç§’ï¼‰
- âœ… åœ¨ llm_client.py çš„ generate_response ä¸Šåº”ç”¨ @async_retry
- âœ… å¯é…ç½®é‡è¯•æ¬¡æ•°å’Œå»¶è¿Ÿ

**é…ç½®é¡¹ï¼ˆå·²æ·»åŠ åˆ° .env å’Œ config.pyï¼‰**:
```
LOG_LEVEL=INFO
LOG_TO_FILE=true
LLM_MAX_RETRIES=3
LLM_RETRY_BASE_DELAY=2.0
LLM_RETRY_MAX_DELAY=30.0
```

**éªŒè¯ç»“æœ**: 
- æ‰€æœ‰åŠŸèƒ½æµ‹è¯• 100% é€šè¿‡
- æ—¥å¿—ç³»ç»Ÿå·¥ä½œæ­£å¸¸ï¼Œå·²ç”Ÿæˆæ—¥å¿—æ–‡ä»¶
- é‡è¯•æœºåˆ¶æµ‹è¯•æˆåŠŸ
- æ‰€æœ‰åŸæœ‰æµ‹è¯•ç»§ç»­é€šè¿‡

---

### æ ¸å¿ƒç»„ä»¶

#### 1. æ¶ˆæ¯æ€»çº¿ (`engine/message_bus.py`)
**èŒè´£**: Agenté—´æ¶ˆæ¯è·¯ç”±ã€è®°å½•å’Œæ¨é€

**å…³é”®æ¥å£**:
```python
class MessageBus:
    __new__() -> MessageBus  # å•ä¾‹æ¨¡å¼
    subscribe(agent_id: str, callback: Callable) -> None
    async send(message: Dict[str, Any]) -> bool
    async receive(agent_id: str, timeout: Optional[float]) -> Optional[Dict]
    get_history(limit: Optional[int], agent_id: Optional[str]) -> List[Dict]
    get_summary() -> Dict[str, Any]
```

**æ ¸å¿ƒåŠŸèƒ½**:
- âœ… å•ä¾‹æ¨¡å¼: å…¨å±€å”¯ä¸€çš„æ¶ˆæ¯æ€»çº¿å®ä¾‹
- âœ… æ¶ˆæ¯è·¯ç”±: ç‚¹å¯¹ç‚¹ã€å¹¿æ’­(to="all")ã€å‘ç»™è€æ¿(to="boss")
- âœ… æ¶ˆæ¯é˜Ÿåˆ—: æ¯ä¸ªAgentæœ‰ç‹¬ç«‹çš„æ¶ˆæ¯é˜Ÿåˆ—
- âœ… æ¶ˆæ¯å†å²: å†…å­˜ä¸­ä¿ç•™æœ€è¿‘1000æ¡æ¶ˆæ¯
- âœ… é¢‘ç‡é™åˆ¶: åŒä¸€å¯¹Agentæ¯åˆ†é’Ÿæœ€å¤š10æ¡æ¶ˆæ¯
- âœ… WebSocketæ¨é€: æ”¯æŒå®æ—¶æ¨é€åˆ°å‰ç«¯(æ¥å£é¢„ç•™)

**æ¶ˆæ¯æ ¼å¼æ ‡å‡†**(å·²åœ¨ç¬¬93è¡Œå®šä¹‰):
```json
{
    "from": "agent_id",
    "to": "target_id",
    "type": "question|answer|report|request_review",
    "content": "æ¶ˆæ¯æ­£æ–‡",
    "context": "å·¥ä½œä¸Šä¸‹æ–‡",
    "priority": "normal|urgent|blocking",
    "timestamp": "ISO8601æ—¶é—´æˆ³"
}
```

---

#### 2. Agentç®¡ç†å™¨ (`engine/agent_manager.py`)
**èŒè´£**: ç®¡ç†æ‰€æœ‰Agentçš„ç”Ÿå‘½å‘¨æœŸå’Œå·¥ä½œå¾ªç¯

**å…³é”®æ¥å£**:
```python
class AgentManager:
    register_agent(agent: Agent) -> None
    unregister_agent(agent_id: str) -> None
    async start_all() -> None
    async stop_all() -> None
    get_summary() -> Dict
```

**Agentå·¥ä½œå¾ªç¯**:
```python
async def _agent_work_loop(agent):
    while running:
        # 1. æ£€æŸ¥æ¶ˆæ¯é˜Ÿåˆ—
        message = await message_bus.receive(agent_id, timeout=2.0)
        if message:
            response = await agent.process_message(message)
            if response:
                await message_bus.send(response)
        
        # 2. TODO: æ£€æŸ¥ä»»åŠ¡é˜Ÿåˆ—(P4å®ç°)
        
        # 3. ç©ºé—²ç­‰å¾…
        await asyncio.sleep(0.1)
```

**æ ¸å¿ƒåŠŸèƒ½**:
- âœ… Agentæ³¨å†Œ: è‡ªåŠ¨è®¢é˜…æ¶ˆæ¯æ€»çº¿
- âœ… å·¥ä½œå¾ªç¯: æ¯ä¸ªAgentç‹¬ç«‹çš„å¼‚æ­¥å·¥ä½œå¾ªç¯
- âœ… ç”Ÿå‘½å‘¨æœŸç®¡ç†: ç»Ÿä¸€å¯åŠ¨/åœæ­¢æ‰€æœ‰Agent
- âœ… çŠ¶æ€ç›‘æ§: è·å–æ‰€æœ‰Agentçš„è¿è¡ŒçŠ¶æ€

---

#### 3. 5ä¸ªå…·ä½“Agent

**å·²å®ç°çš„Agent**:

| Agent ID | è§’è‰² | æ–‡ä»¶ | æ ¸å¿ƒèŒè´£ |
|----------|------|------|---------|
| `pm` | é¡¹ç›®ç»ç† | `agents/pm_agent.py` | æ¥æ”¶éœ€æ±‚ã€æ‹†è§£ä»»åŠ¡ã€åè°ƒå†²çªã€æ±‡æŠ¥è€æ¿ |
| `planner` | æ¸¸æˆç­–åˆ’ | `agents/planner_agent.py` | ç¼–å†™GDDã€è®¾è®¡ç©æ³•ã€è¾“å‡ºé…ç½®è¡¨ |
| `programmer` | æ¸¸æˆç¨‹åºå‘˜ | `agents/programmer_agent.py` | ç¼–å†™ä»£ç ã€éµå®ˆè§„èŒƒã€ä¿®å¤Bug |
| `artist` | ç¾æœ¯è®¾è®¡å¸ˆ | `agents/artist_agent.py` | ç”Ÿæˆç´ æã€ç¼–å†™Promptã€è°ƒç”¨AIç»˜å›¾ |
| `tester` | æµ‹è¯•å·¥ç¨‹å¸ˆ | `agents/tester_agent.py` | æµ‹è¯•åŠŸèƒ½ã€ç¼–å†™BugæŠ¥å‘Šã€å›å½’æµ‹è¯• |

**æ‰€æœ‰Agentå…±äº«çš„èƒ½åŠ›**(ç»§æ‰¿è‡ªAgentåŸºç±»):
- `async think_and_respond(message)` - è°ƒç”¨LLMç”Ÿæˆå›å¤
- `async process_message(message)` - å¤„ç†æ”¶åˆ°çš„æ¶ˆæ¯
- `load_file_to_context(file, content)` - åŠ è½½æ–‡ä»¶åˆ°ä¸Šä¸‹æ–‡
- `get_status()` - è·å–AgentçŠ¶æ€
- `reset_context()` - æ¸…ç©ºä¸Šä¸‹æ–‡

**å„Agentçš„System Promptè¦ç‚¹**:
- PM: æ‹†è§£ä»»åŠ¡ã€åè°ƒå†²çªã€é‡å¤§å†³ç­–è¯·ç¤ºè€æ¿
- ç­–åˆ’: è¾“å‡ºYAMLé…ç½®ã€ç©æ³•æ¸…æ™°ã€è€ƒè™‘æŠ€æœ¯å¯è¡Œæ€§
- ç¨‹åºå‘˜: é“å¾‹(å¿…é¡»æŸ¥api_registryã€ç¦æ­¢é‡å¤ä»£ç ã€ç¦æ­¢ç¡¬ç¼–ç )
- ç¾æœ¯: åƒç´ é£æ ¼ã€è¯¦ç»†Promptã€ç¬¦åˆè§„èŒƒ
- æµ‹è¯•: å®¢è§‚å‡†ç¡®ã€è¯¦ç»†å¤ç°æ­¥éª¤ã€åŒºåˆ†Bugå’Œè®¾è®¡é—®é¢˜

---

### æµ‹è¯•éªŒè¯

**æµ‹è¯•è„šæœ¬**: `test_p2_integration.py`

**æµ‹è¯•ç»“æœ**: âœ… 100% é€šè¿‡
- âœ… æ¶ˆæ¯æ€»çº¿: å•ä¾‹ã€è®¢é˜…ã€è·¯ç”±ã€å†å²
- âœ… 5ä¸ªAgent: åˆ›å»ºã€å¯¹è¯ã€System Promptç”Ÿæ•ˆ
- âœ… Agentç®¡ç†å™¨: æ³¨å†Œã€å¯åŠ¨ã€åœæ­¢
- âœ… å¤šAgenté€šä¿¡: PMâ†”ç­–åˆ’ã€ç­–åˆ’â†’ç¨‹åºå‘˜

**å®é™…å¯¹è¯æµ‹è¯•**:
- PMå‘é—®"è¯·ç®€è¦è¯´æ˜è´ªåƒè›‡çš„æ ¸å¿ƒç©æ³•" â†’ ç­–åˆ’å›å¤"æ§åˆ¶ä¸€æ¡è›‡åœ¨åœ°å›¾ä¸Šç§»åŠ¨ï¼Œé€šè¿‡åƒé£Ÿç‰©å¢é•¿èº«ä½“ï¼ŒåŒæ—¶é¿å…æ’åˆ°è‡ªå·±æˆ–å¢™å£"
- æ¶ˆæ¯è·¯ç”±æ­£ç¡®ï¼Œå›å¤è´¨é‡é«˜

---

### æ¶æ„å†³ç­–

**1. ä¸ºä»€ä¹ˆç”¨å•ä¾‹æ¨¡å¼çš„æ¶ˆæ¯æ€»çº¿ï¼Ÿ**
- å…¨å±€å”¯ä¸€ï¼Œé¿å…å¤šä¸ªæ€»çº¿å®ä¾‹å¯¼è‡´æ¶ˆæ¯æ··ä¹±
- ä¾¿äºå…¨å±€è®¿é—®å’ŒçŠ¶æ€ç®¡ç†

**2. ä¸ºä»€ä¹ˆAgentå·¥ä½œå¾ªç¯ç”¨timeout=2.0ï¼Ÿ**
- å¹³è¡¡å“åº”é€Ÿåº¦å’ŒCPUå ç”¨
- 2ç§’è¶³å¤Ÿå¿«ï¼Œä¸ä¼šè®©ç”¨æˆ·æ„Ÿè§‰å¡é¡¿

**3. ä¸ºä»€ä¹ˆé™åˆ¶æ¯åˆ†é’Ÿ10æ¡æ¶ˆæ¯ï¼Ÿ**
- é˜²æ­¢Agenté™·å…¥æ— æ„ä¹‰çš„å¯¹è¯å¾ªç¯
- èŠ‚çœAPIè°ƒç”¨æˆæœ¬

**4. ä¸ºä»€ä¹ˆç°åœ¨ä¸å®ç°ä»»åŠ¡é˜Ÿåˆ—ï¼Ÿ**
- P2é˜¶æ®µé‡ç‚¹æ˜¯æ¶ˆæ¯é€šä¿¡
- ä»»åŠ¡é˜Ÿåˆ—åœ¨P4é˜¶æ®µ(æ¸¸æˆå¼€å‘å·¥ä½œæµ)ä¸­å®ç°

---

### ä¸‹ä¸€é˜¶æ®µéœ€è¦çŸ¥é“çš„

**P3é˜¶æ®µ(å·¥å…·ç³»ç»Ÿ)éœ€è¦é›†æˆçš„æ¥å£**:
- Agentéœ€è¦è°ƒç”¨å·¥å…·: `file_tool.read()`, `file_tool.write()`, `code_runner.execute()`
- å·¥å…·è°ƒç”¨åº”è¯¥åœ¨Agentçš„`process_message`ä¸­æ ¹æ®LLMå›å¤è§¦å‘

**æ–‡ä»¶è¯»å†™çº¦å®š**(P4é˜¶æ®µç”¨):
| Agent | å¿…è¯»æ–‡ä»¶ | å¿…å†™æ–‡ä»¶ |
|-------|---------|---------|
| PM | æ—  | decision_log.yaml |
| ç­–åˆ’ | project_rules.yaml | game_design_doc.md, config_tables.yaml |
| ç¨‹åºå‘˜ | api_registry.yaml, config_tables.yaml | ä»£ç æ–‡ä»¶, api_registry.yaml |
| ç¾æœ¯ | art_asset_list.yaml | ç´ ææ–‡ä»¶, art_asset_list.yaml |
| æµ‹è¯• | game_design_doc.md | bug_tracker.yaml |

---

## ğŸ› ï¸ P3: å·¥å…·ç³»ç»Ÿ

> **çŠ¶æ€**: âœ… å·²å®Œæˆ (2026-02-11)

### æ ¸å¿ƒç»„ä»¶

#### 1. æ–‡ä»¶å·¥å…· (`tools/file_tool.py`)
**èŒè´£**: æä¾›å®‰å…¨çš„æ–‡ä»¶è¯»å†™æ“ä½œ

**å…³é”®æ¥å£**:
```python
class FileTool:
    async read(file_path: str) -> str
    async write(file_path: str, content: str) -> bool
    async append(file_path: str, content: str) -> bool
    exists(file_path: str) -> bool
    is_file(file_path: str) -> bool
    is_directory(file_path: str) -> bool
    async list_directory(dir_path: str) -> List[Dict]
    async delete(file_path: str) -> bool
    get_file_info(file_path: str) -> Dict
```

**å®‰å…¨ç‰¹æ€§**:
- âœ… è·¯å¾„å®‰å…¨æ£€æŸ¥: æ‰€æœ‰è·¯å¾„å¿…é¡»åœ¨å·¥ä½œç©ºé—´å†…
- âœ… è‡ªåŠ¨åˆ›å»ºçˆ¶ç›®å½•
- âœ… UTF-8ç¼–ç å¤„ç†
- âœ… å¼‚æ­¥IOæ“ä½œ

---

#### 2. ä»£ç æ‰§è¡Œå·¥å…· (`tools/code_runner.py`)
**èŒè´£**: åœ¨å®‰å…¨ç¯å¢ƒä¸­æ‰§è¡ŒJavaScript/HTMLä»£ç 

**å…³é”®æ¥å£**:
```python
class CodeRunner:
    async execute_html(html_content: str, timeout: float, check_only: bool) -> Dict
    async execute_js(js_code: str, timeout: float, use_node: bool) -> Dict
    async validate_syntax(code: str, language: str) -> Dict
    async execute_game_test(game_dir: str, entry_file: str) -> Dict
    cleanup_temp_files() -> int
```

**å®‰å…¨ç‰¹æ€§**:
- âœ… éš”ç¦»ä¸´æ—¶ç›®å½•: ä»£ç åœ¨ç‹¬ç«‹ä¸´æ—¶ç›®å½•æ‰§è¡Œ
- âœ… è¶…æ—¶ä¿æŠ¤: é»˜è®¤10-30ç§’è¶…æ—¶
- âœ… è¿›ç¨‹éš”ç¦»: ä½¿ç”¨å­è¿›ç¨‹æ‰§è¡Œ
- âœ… Node.jsæ£€æµ‹: è‡ªåŠ¨æ£€æµ‹ç¯å¢ƒå¯ç”¨æ€§

---

#### 3. ä»£ç æœç´¢å·¥å…· (`tools/code_search_tool.py`)
**èŒè´£**: æœç´¢ä»£ç ä¸­çš„å‡½æ•°ã€ç±»ã€å˜é‡å®šä¹‰

**å…³é”®æ¥å£**:
```python
class CodeSearchTool:
    async search_function(name: str, directory: str, pattern: str) -> List[Dict]
    async search_class(name: str, directory: str, pattern: str) -> List[Dict]
    async search_variable(name: str, directory: str, pattern: str) -> List[Dict]
    async search_all(name: str, directory: str, pattern: str) -> Dict
    async get_api_registry(registry_file: str) -> Dict
    async check_function_exists(function_name: str) -> bool
    get_file_imports(file_path: str) -> List[str]
```

**æ ¸å¿ƒåŠŸèƒ½**:
- âœ… æ­£åˆ™æ¨¡å¼åŒ¹é…: æ”¯æŒå¤šç§JavaScriptå®šä¹‰è¯­æ³•
- âœ… é€’å½’æœç´¢: è‡ªåŠ¨éå†å­ç›®å½•
- âœ… APIæ³¨å†Œè¡¨é›†æˆ: é˜²æ­¢é‡å¤å®ç°
- âœ… å¯¼å…¥è¯­å¥åˆ†æ: ç†è§£ä»£ç ä¾èµ–å…³ç³»

---

#### 4. å·¥å…·æ³¨å†Œæœºåˆ¶ (`tools/tool_registry.py`)
**èŒè´£**: å…¨å±€å·¥å…·ç®¡ç†å’Œæƒé™æ§åˆ¶

**å…³é”®æ¥å£**:
```python
class ToolRegistry:  # å•ä¾‹æ¨¡å¼
    register_tool(name: str, tool_instance: Any) -> None
    get_tool(name: str) -> Optional[Any]
    async call_tool(tool_name: str, method_name: str, *args, **kwargs) -> Any
    list_tools() -> List[Dict]

class AgentToolkit:  # æ¯ä¸ªAgentä¸€ä¸ªå®ä¾‹
    enable_tool(tool_name: str) -> bool
    disable_tool(tool_name: str) -> bool
    async call(tool_name: str, method_name: str, *args, **kwargs) -> Any
    get_available_tools() -> List[Dict]
    get_tool_info_for_prompt() -> str
```

**æ¶æ„è®¾è®¡**:
- âœ… å•ä¾‹å·¥å…·æ³¨å†Œè¡¨: å…¨å±€å”¯ä¸€ï¼Œæ‰€æœ‰Agentå…±äº«
- âœ… æƒé™æ§åˆ¶: Agentåªèƒ½è°ƒç”¨å·²å¯ç”¨çš„å·¥å…·
- âœ… è‡ªåŠ¨æ–¹æ³•æ£€æµ‹: æ”¯æŒåŒæ­¥å’Œå¼‚æ­¥æ–¹æ³•
- âœ… Promptç”Ÿæˆ: è‡ªåŠ¨ç”Ÿæˆå·¥å…·è¯´æ˜ä¾›LLMç†è§£

**å·²æ³¨å†Œçš„å·¥å…·**:
| å·¥å…·å | ç±»å‹ | ç”¨é€” |
|-------|------|------|
| file | FileTool | æ–‡ä»¶è¯»å†™æ“ä½œ |
| code_runner | CodeRunner | ä»£ç æ‰§è¡Œå’Œæµ‹è¯• |
| code_search | CodeSearchTool | ä»£ç æœç´¢å’Œåˆ†æ |

---

#### 5. AgentåŸºç±»é›†æˆ (`engine/agent.py` æ›´æ–°)

**æ–°å¢åŠŸèƒ½**:
```python
class Agent:
    def __init__(tools: Optional[List[str]] = None):  # æ–°å¢å‚æ•°
        self.toolkit = AgentToolkit(agent_id)  # å·¥å…·åŒ…
        
    async call_tool(tool_name: str, method_name: str, *args, **kwargs) -> Any
    enable_tool(tool_name: str) -> bool
    get_available_tools() -> List[Dict]
```

**ä½¿ç”¨ç¤ºä¾‹**:
```python
# åˆ›å»ºå¸¦å·¥å…·çš„Agent
agent = Agent(
    agent_id="programmer",
    role="ç¨‹åºå‘˜",
    system_prompt="...",
    tools=["file", "code_search", "code_runner"]
)

# Agentè°ƒç”¨å·¥å…·
await agent.call_tool("file", "write", "game.js", code)
results = await agent.call_tool("code_search", "search_function", "move")
```

---

### æµ‹è¯•éªŒè¯

**æµ‹è¯•è„šæœ¬**: `test_p3_tools.py`

**æµ‹è¯•ç»“æœ**: âœ… 100% é€šè¿‡ (6/6)
- âœ… æ–‡ä»¶å·¥å…·: è¯»å†™ã€è¿½åŠ ã€åˆ é™¤ã€åˆ—è¡¨ã€æƒé™æ£€æŸ¥
- âœ… ä»£ç æ‰§è¡Œå·¥å…·: JS/HTMLæ‰§è¡Œã€è¯­æ³•æ£€æŸ¥ã€è¶…æ—¶æ§åˆ¶
- âœ… ä»£ç æœç´¢å·¥å…·: å‡½æ•°/ç±»/å˜é‡æœç´¢ã€APIæ³¨å†Œè¡¨
- âœ… å·¥å…·æ³¨å†Œæœºåˆ¶: æ³¨å†Œã€è°ƒç”¨ã€æƒé™æ§åˆ¶
- âœ… Agentå·¥å…·åŒ…: å¯ç”¨ã€è°ƒç”¨ã€Promptç”Ÿæˆ
- âœ… Agenté›†æˆ: åˆ›å»ºã€è°ƒç”¨ã€åŠ¨æ€å¯ç”¨

**å®é™…éªŒè¯**:
- AgentæˆåŠŸè¯»å†™æ–‡ä»¶
- AgentæˆåŠŸæœç´¢ä»£ç å¹¶æ‰¾åˆ°å®šä¹‰
- AgentæˆåŠŸæ‰§è¡ŒJavaScriptä»£ç 
- æƒé™æ§åˆ¶æ­£å¸¸å·¥ä½œï¼ˆæœªå¯ç”¨å·¥å…·æ— æ³•è°ƒç”¨ï¼‰

---

### æ¶æ„å†³ç­–

**1. ä¸ºä»€ä¹ˆä½¿ç”¨å•ä¾‹å·¥å…·æ³¨å†Œè¡¨ï¼Ÿ**
- å…¨å±€å”¯ä¸€ï¼Œé¿å…é‡å¤åˆ›å»ºå·¥å…·å®ä¾‹
- ä¾¿äºç»Ÿä¸€ç®¡ç†å’Œç›‘æ§
- èŠ‚çœå†…å­˜ï¼ˆæ‰€æœ‰Agentå…±äº«å·¥å…·å®ä¾‹ï¼‰

**2. ä¸ºä»€ä¹ˆä½¿ç”¨AgentToolkitåŒ…è£…ï¼Ÿ**
- æƒé™éš”ç¦»ï¼šæ¯ä¸ªAgentåªèƒ½ç”¨è‡ªå·±å¯ç”¨çš„å·¥å…·
- å®¡è®¡è¿½è¸ªï¼šè®°å½•å“ªä¸ªAgentè°ƒç”¨äº†ä»€ä¹ˆå·¥å…·
- çµæ´»é…ç½®ï¼šä¸åŒAgentå¯å¯ç”¨ä¸åŒå·¥å…·é›†

**3. ä¸ºä»€ä¹ˆæ–‡ä»¶å·¥å…·æœ‰è·¯å¾„å®‰å…¨æ£€æŸ¥ï¼Ÿ**
- é˜²æ­¢Agentè®¿é—®å·¥ä½œç©ºé—´å¤–çš„æ•æ„Ÿæ–‡ä»¶
- éµå¾ª"æœ€å°æƒé™"åŸåˆ™
- ç¬¦åˆç”Ÿäº§ç¯å¢ƒå®‰å…¨æ ‡å‡†

**4. ä¸ºä»€ä¹ˆä»£ç æ‰§è¡Œä½¿ç”¨ä¸´æ—¶ç›®å½•ï¼Ÿ**
- éš”ç¦»æ‰§è¡Œç¯å¢ƒï¼Œé¿å…æ±¡æŸ“é¡¹ç›®ç›®å½•
- ä¾¿äºæ¸…ç†ä¸´æ—¶æ–‡ä»¶
- é™ä½å®‰å…¨é£é™©

---

### ä¸‹ä¸€é˜¶æ®µéœ€è¦çŸ¥é“çš„

**P4é˜¶æ®µ(å·¥ä½œæµ)éœ€è¦çš„å·¥å…·è°ƒç”¨åœºæ™¯**:

| Agent | å¸¸ç”¨å·¥å…·è°ƒç”¨ |
|-------|------------|
| **ç­–åˆ’** | `file.write(game_design_doc.md)`, `file.write(config_tables.yaml)` |
| **ç¨‹åºå‘˜** | `code_search.check_function_exists()`, `file.write(xxx.js)`, `code_search.get_api_registry()` |
| **ç¾æœ¯** | `file.write(assets/xxx.png)` (æœªæ¥æ¥å…¥ç»˜å›¾API) |
| **æµ‹è¯•** | `code_runner.execute_game_test()`, `file.write(bug_tracker.yaml)` |

**å·¥å…·è°ƒç”¨æµç¨‹**:
```
Agentæ”¶åˆ°ä»»åŠ¡ 
  â†’ Agentæ€è€ƒéœ€è¦ä»€ä¹ˆå·¥å…·
  â†’ è°ƒç”¨ await self.call_tool(tool_name, method_name, ...)
  â†’ å·¥å…·æ‰§è¡Œå¹¶è¿”å›ç»“æœ
  â†’ Agentæ ¹æ®ç»“æœç»§ç»­å·¥ä½œæˆ–æ±‡æŠ¥
```

---

## ğŸ® P4: æ¸¸æˆå¼€å‘å·¥ä½œæµ

> **çŠ¶æ€**: âœ… å·²å®Œæˆ (2026-02-11)

### æ ¸å¿ƒç»„ä»¶

#### 1. æ¸¸æˆå¼€å‘å·¥ä½œæµ (`workflows/game_dev_workflow.py`)
**èŒè´£**: å®šä¹‰å’Œæ‰§è¡Œå®Œæ•´çš„7é˜¶æ®µæ¸¸æˆå¼€å‘æµç¨‹

**å…³é”®æ¥å£**:
```python
class GameDevWorkflow:
    __init__(project_name: str, project_description: str)
    async initialize() -> None
    async start() -> None
    get_status() -> Dict[str, Any]
```

**7ä¸ªå¼€å‘é˜¶æ®µ**:
1. `_phase_1_initiation()` - ç«‹é¡¹ï¼šPMæ¥æ”¶éœ€æ±‚ï¼Œç»„ç»‡å…¨å‘˜ä¼šè®®
2. `_phase_2_planning()` - ç­–åˆ’ï¼šç­–åˆ’ç¼–å†™GDDï¼Œç”Ÿæˆç­–åˆ’æ–‡æ¡£
3. `_phase_3_tech_design()` - æŠ€æœ¯è®¾è®¡ï¼šç¨‹åºå‘˜è®¾è®¡æ¶æ„ï¼Œç”ŸæˆTDD
4. `_phase_4_parallel_dev()` - å¹¶è¡Œå¼€å‘ï¼šç¨‹åºå‘˜+ç¾æœ¯å¹¶è¡Œå·¥ä½œ
5. `_phase_5_integration()` - æ•´åˆï¼šæ•´åˆä»£ç å’Œç´ æï¼ˆç®€åŒ–ç‰ˆè·³è¿‡ï¼‰
6. `_phase_6_testing()` - æµ‹è¯•ï¼šæµ‹è¯•å·¥ç¨‹å¸ˆæµ‹è¯•æ¸¸æˆ
7. `_phase_7_delivery()` - äº¤ä»˜ï¼šPMæ±‡æŠ¥é¡¹ç›®å®Œæˆ

**æ ¸å¿ƒåŠŸèƒ½**:
- âœ… è‡ªåŠ¨åˆ›å»ºé¡¹ç›®ç›®å½•ç»“æ„
- âœ… ç”Ÿæˆå’Œç®¡ç†å…±äº«çŸ¥è¯†åº“æ–‡ä»¶
- âœ… Agentå·¥ä½œå¾ªç¯å’Œæ¶ˆæ¯é€šä¿¡
- âœ… é˜¶æ®µé—´æ–‡æ¡£ä¼ é€’
- âœ… çŠ¶æ€æŸ¥è¯¢å’Œç›‘æ§

---

#### 2. å…±äº«çŸ¥è¯†åº“ç³»ç»Ÿ

**çŸ¥è¯†åº“æ–‡ä»¶åˆ—è¡¨** (æ¯ä¸ªé¡¹ç›®è‡ªåŠ¨åˆ›å»º):

| æ–‡ä»¶ | èŒè´£ | åˆ›å»ºè€… | ä¸»è¦è¯»å–è€… |
|------|------|--------|-----------|
| **project_rules.yaml** | é¡¹ç›®è§„èŒƒï¼ˆå‘½åã€ç»“æ„ã€ä»£ç è§„èŒƒï¼‰ | ç³»ç»Ÿ | æ‰€æœ‰Agent |
| **game_design_doc.md** | æ¸¸æˆç­–åˆ’æ–‡æ¡£(GDD) | ç­–åˆ’ | ç¨‹åºå‘˜ã€ç¾æœ¯ã€æµ‹è¯• |
| **tech_design_doc.md** | æŠ€æœ¯è®¾è®¡æ–‡æ¡£(TDD) | ç¨‹åºå‘˜ | ç¨‹åºå‘˜ã€æµ‹è¯• |
| **api_registry.yaml** | æ¥å£æ³¨å†Œè¡¨ï¼ˆé˜²æ­¢é‡å¤ä»£ç ï¼‰ | ç¨‹åºå‘˜ | ç¨‹åºå‘˜ |
| **config_tables.yaml** | æ¸¸æˆé…ç½®æ•°æ® | ç­–åˆ’ | ç¨‹åºå‘˜ |
| **art_asset_list.yaml** | ç¾æœ¯ç´ ææ¸…å• | ç¾æœ¯ | ç¾æœ¯ã€ç¨‹åºå‘˜ |
| **bug_tracker.yaml** | Bugè¿½è¸ªåˆ—è¡¨ | æµ‹è¯• | æµ‹è¯•ã€ç¨‹åºå‘˜ |
| **decision_log.yaml** | è€æ¿å†³ç­–è®°å½• | PM | PMã€æ‰€æœ‰Agent |

**æ–‡ä»¶å³çœŸç›¸åŸåˆ™**:
- Agentå·¥ä½œå‰å¿…é¡»è¯»å–ç›¸å…³æ–‡ä»¶
- æ‰€æœ‰è¾“å‡ºå¿…é¡»å†™å…¥çŸ¥è¯†åº“æ–‡ä»¶
- æ–‡ä»¶å†…å®¹æ˜¯å”¯ä¸€çš„äº‹å®æ¥æº

---

#### 3. é¡¹ç›®ç›®å½•ç»“æ„

**è‡ªåŠ¨åˆ›å»ºçš„ç›®å½•**:
```
projects/{project_name}/
â”œâ”€â”€ shared_knowledge/       # å…±äº«çŸ¥è¯†åº“ï¼ˆ8ä¸ªYAML/MDæ–‡ä»¶ï¼‰
â”œâ”€â”€ output/                 # æ¸¸æˆäº§å‡ºç›®å½•
â”‚   â”œâ”€â”€ js/                # JavaScriptä»£ç 
â”‚   â”œâ”€â”€ assets/            # ç¾æœ¯ç´ æ
â”‚   â””â”€â”€ css/               # æ ·å¼æ–‡ä»¶
â””â”€â”€ logs/                  # é¡¹ç›®æ—¥å¿—
```

---

#### 4. é˜¶æ®µé—´æ–‡æ¡£ä¼ é€’æµç¨‹

```
é˜¶æ®µ1: ç«‹é¡¹
  è¾“å…¥: ç”¨æˆ·éœ€æ±‚ (project_description)
  è¾“å‡º: project_rules.yaml
  
é˜¶æ®µ2: ç­–åˆ’
  è¾“å…¥: project_rules.yaml
  è¾“å‡º: game_design_doc.md, config_tables.yaml
  
é˜¶æ®µ3: æŠ€æœ¯è®¾è®¡
  è¾“å…¥: project_rules.yaml, game_design_doc.md
  è¾“å‡º: tech_design_doc.md, api_registry.yaml
  
é˜¶æ®µ4: å¹¶è¡Œå¼€å‘
  è¾“å…¥: æ‰€æœ‰çŸ¥è¯†åº“æ–‡ä»¶
  è¾“å‡º: ä»£ç æ–‡ä»¶ï¼ˆP4ç®€åŒ–ç‰ˆæœªå®ç°ï¼‰
  
é˜¶æ®µ5: æ•´åˆ
  è¾“å…¥: ä»£ç  + ç¾æœ¯ç´ æ
  è¾“å‡º: å®Œæ•´æ¸¸æˆï¼ˆP4ç®€åŒ–ç‰ˆè·³è¿‡ï¼‰
  
é˜¶æ®µ6: æµ‹è¯•
  è¾“å…¥: game_design_doc.md, æ¸¸æˆä»£ç 
  è¾“å‡º: bug_tracker.yaml
  
é˜¶æ®µ7: äº¤ä»˜
  è¾“å…¥: æ‰€æœ‰æ–‡ä»¶
  è¾“å‡º: æ±‡æŠ¥ç»™è€æ¿
```

---

### æµ‹è¯•éªŒè¯

**æµ‹è¯•è„šæœ¬**: 
- `test_p4_workflow.py` - 6ä¸ªåŸºç¡€åŠŸèƒ½æµ‹è¯•
- `test_p4_full_workflow.py` - å®Œæ•´7é˜¶æ®µå·¥ä½œæµæµ‹è¯•

**æµ‹è¯•ç»“æœ**: âœ… 100% é€šè¿‡ (7/7)
- âœ… å·¥ä½œæµåˆå§‹åŒ–
- âœ… é¡¹ç›®ç›®å½•ç»“æ„åˆ›å»º
- âœ… å…±äº«çŸ¥è¯†åº“æ–‡ä»¶åˆ›å»ºï¼ˆ8ä¸ªæ–‡ä»¶ï¼‰
- âœ… Agentåˆ›å»ºå’Œæ³¨å†Œï¼ˆ5ä¸ªAgentï¼‰
- âœ… é˜¶æ®µæ‰§è¡Œæµç¨‹
- âœ… å·¥ä½œæµçŠ¶æ€æŸ¥è¯¢
- âœ… å®Œæ•´7é˜¶æ®µç«¯åˆ°ç«¯æµ‹è¯•

**å®é™…éªŒè¯**:
- æˆåŠŸè¿è¡Œå®Œæ•´çš„æ¸¸æˆå¼€å‘å·¥ä½œæµ
- è‡ªåŠ¨ç”Ÿæˆé¡¹ç›®ç›®å½•å’ŒçŸ¥è¯†åº“æ–‡ä»¶
- AgentæˆåŠŸåä½œå®Œæˆå„é˜¶æ®µä»»åŠ¡
- æ¶ˆæ¯è·¯ç”±æ­£ç¡®ï¼Œæ–‡æ¡£ä¼ é€’æ­£å¸¸

---

### æ¶æ„å†³ç­–

**1. ä¸ºä»€ä¹ˆä½¿ç”¨é˜¶æ®µåŒ–æµç¨‹ï¼Ÿ**
- æ¨¡æ‹ŸçœŸå®æ¸¸æˆå¼€å‘æµç¨‹
- ä¾¿äºç›‘æ§å’Œè°ƒè¯•
- æ”¯æŒäººç±»åœ¨å…³é”®èŠ‚ç‚¹ä»‹å…¥

**2. ä¸ºä»€ä¹ˆä½¿ç”¨å…±äº«çŸ¥è¯†åº“ï¼Ÿ**
- å®ç°"æ–‡ä»¶å³çœŸç›¸"åŸåˆ™
- è§£å†³Agentè®°å¿†æ··ä¹±é—®é¢˜
- ä¾¿äºè¿½æº¯å’Œå®¡è®¡

**3. ä¸ºä»€ä¹ˆP4ç®€åŒ–äº†å®é™…ä»£ç ç”Ÿæˆï¼Ÿ**
- èšç„¦å·¥ä½œæµæ¡†æ¶æ­å»º
- å®é™…ä»£ç ç”Ÿæˆéœ€è¦æ›´å¤æ‚çš„Promptå·¥ç¨‹
- ç•™å¾…P8è”è°ƒé˜¶æ®µå®Œå–„

**4. ä¸ºä»€ä¹ˆéœ€è¦project_rules.yamlï¼Ÿ**
- ç»Ÿä¸€æ‰€æœ‰Agentçš„ä»£ç è§„èŒƒ
- é˜²æ­¢å‘½åä¸ä¸€è‡´
- ç¡®ä¿æŠ€æœ¯æ ˆç»Ÿä¸€

---

### P4é˜¶æ®µç®€åŒ–è¯´æ˜

**å·²å®ç°**:
- âœ… å®Œæ•´çš„7é˜¶æ®µæµç¨‹å®šä¹‰
- âœ… é¡¹ç›®ç›®å½•å’ŒçŸ¥è¯†åº“ç®¡ç†
- âœ… Agentæ¶ˆæ¯åä½œ
- âœ… æ–‡æ¡£ä¼ é€’æœºåˆ¶

**ç®€åŒ–å†…å®¹**ï¼ˆå°†åœ¨åç»­é˜¶æ®µå®Œå–„ï¼‰:
- â¸ï¸ é˜¶æ®µ4: å®é™…ä»£ç ç”Ÿæˆï¼ˆAgentå›å¤ä½†æœªç”Ÿæˆæ–‡ä»¶ï¼‰
- â¸ï¸ é˜¶æ®µ5: ä»£ç å’Œç´ ææ•´åˆï¼ˆè·³è¿‡ï¼‰
- â¸ï¸ é˜¶æ®µ6: å®é™…ä»£ç æµ‹è¯•ï¼ˆAgentå›å¤ä½†æœªæ‰§è¡Œï¼‰
- â¸ï¸ Bugä¿®å¤å¾ªç¯ï¼ˆæœªå®ç°ï¼‰

**å®Œå–„è®¡åˆ’**:
- P5: Web APIï¼ˆæ¥å…¥å‰ç«¯æ§åˆ¶ï¼‰
- P6: å‰ç«¯å¯è§†åŒ–ï¼ˆè§‚å¯Ÿå·¥ä½œæµï¼‰
- P7: äººç±»ä»‹å…¥ï¼ˆè€æ¿å†³ç­–ï¼‰
- P8: è”è°ƒæµ‹è¯•ï¼ˆå®Œæ•´ç”ŸæˆçœŸå®æ¸¸æˆï¼‰

---

### ä¸‹ä¸€é˜¶æ®µéœ€è¦çŸ¥é“çš„

**P5é˜¶æ®µ(Webåç«¯API)éœ€è¦é›†æˆçš„æ¥å£**:

```python
# å¯åŠ¨æ¸¸æˆé¡¹ç›®
POST /project/start
{
    "project_name": "snake_game",
    "project_description": "åšä¸€ä¸ªè´ªåƒè›‡æ¸¸æˆ..."
}

# æŸ¥è¯¢é¡¹ç›®çŠ¶æ€
GET /project/{project_name}/status

# è€æ¿æäº¤å†³ç­–
POST /boss/decision
{
    "project_name": "snake_game",
    "decision": "approve",
    "comment": "å¾ˆå¥½ï¼Œç»§ç»­"
}

# WebSocketæ¨é€
WebSocket /ws - å®æ—¶æ¨é€Agentæ¶ˆæ¯å’ŒçŠ¶æ€å˜åŒ–
```

**éœ€è¦çš„åå°ä»»åŠ¡ç®¡ç†**:
- å·¥ä½œæµä½œä¸ºåå°å¼‚æ­¥ä»»åŠ¡è¿è¡Œ
- æ”¯æŒå¤šä¸ªé¡¹ç›®å¹¶è¡Œå¼€å‘
- çŠ¶æ€æŸ¥è¯¢å’Œç›‘æ§

---

## ğŸŒ P5: Webåç«¯API

> **çŠ¶æ€**: âœ… å·²å®Œæˆï¼ˆ2026-02-11ï¼‰

### æ ¸å¿ƒæ–‡ä»¶

1. **main.py** - FastAPIåº”ç”¨å…¥å£
   - ä½¿ç”¨lifespanä¸Šä¸‹æ–‡ç®¡ç†å™¨ï¼ˆæ›¿ä»£åºŸå¼ƒçš„on_eventï¼‰
   - é›†æˆCORSä¸­é—´ä»¶
   - æŒ‚è½½é™æ€æ–‡ä»¶ï¼ˆå‰ç«¯ï¼‰
   - å¯åŠ¨é…ç½®éªŒè¯

2. **api/http_routes.py** - HTTP REST API
   - ä½¿ç”¨Pydanticæ¨¡å‹éªŒè¯è¯·æ±‚/å“åº”
   - å†…å­˜å­˜å‚¨ï¼ˆprojects_store, pending_decisionsï¼‰
   - å®Œæ•´çš„é”™è¯¯å¤„ç†

3. **api/websocket_handler.py** - WebSocketå®æ—¶é€šä¿¡
   - ConnectionManagerå•ä¾‹ç®¡ç†æ‰€æœ‰è¿æ¥
   - æ”¯æŒç‚¹å¯¹ç‚¹å’Œå¹¿æ’­æ¶ˆæ¯
   - è¿æ¥çŠ¶æ€è·Ÿè¸ª

### HTTP APIç«¯ç‚¹

| æ–¹æ³• | è·¯å¾„ | åŠŸèƒ½ | è¯·æ±‚ä½“ | å“åº” |
|------|------|------|--------|------|
| GET | /api/health | å¥åº·æ£€æŸ¥ | - | {status, service, version} |
| POST | /api/project/start | åˆ›å»ºæ–°é¡¹ç›® | ProjectStartRequest | ProjectStartResponse |
| GET | /api/project/{id}/status | æŸ¥è¯¢é¡¹ç›®çŠ¶æ€ | - | ProjectStatusResponse |
| GET | /api/projects | è·å–é¡¹ç›®åˆ—è¡¨ | ?status, ?limit, ?offset | ProjectListResponse |
| POST | /api/boss/decision | æäº¤è€æ¿å†³ç­– | BossDecisionRequest | BossDecisionResponse |
| DELETE | /api/project/{id} | åˆ é™¤é¡¹ç›® | - | {success, message} |

### WebSocketäº‹ä»¶ç±»å‹

**å®¢æˆ·ç«¯ â†’ æœåŠ¡å™¨**:
- `ping` - å¿ƒè·³æ£€æµ‹
- `subscribe_project` - è®¢é˜…é¡¹ç›®æ›´æ–°
- `unsubscribe_project` - å–æ¶ˆè®¢é˜…

**æœåŠ¡å™¨ â†’ å®¢æˆ·ç«¯**:
- `connected` - è¿æ¥æˆåŠŸç¡®è®¤
- `pong` - å¿ƒè·³å“åº”
- `subscribed` / `unsubscribed` - è®¢é˜…çŠ¶æ€ç¡®è®¤
- `agent_message` - Agentæ¶ˆæ¯æ¨é€
- `agent_status` - AgentçŠ¶æ€å˜åŒ–
- `file_update` - æ–‡ä»¶æ›´æ–°äº‹ä»¶
- `phase_change` - é¡¹ç›®é˜¶æ®µå˜åŒ–
- `boss_decision` - è¯·æ±‚è€æ¿å†³ç­–
- `task_complete` - ä»»åŠ¡å®Œæˆé€šçŸ¥
- `error_alert` - é”™è¯¯è­¦æŠ¥

### å¯¼å‡ºçš„å·¥å…·å‡½æ•°

```python
# websocket_handler.py å¯¼å‡ºçš„å‡½æ•°ï¼ˆä¾›å…¶ä»–æ¨¡å—è°ƒç”¨ï¼‰
async def broadcast_agent_message(project_id, from_agent, to_agent, type, content, context)
async def broadcast_agent_status(project_id, agent_id, status, current_task)
async def broadcast_file_update(project_id, file_path, update_type, updated_by)
async def broadcast_phase_change(project_id, old_phase, new_phase, progress)
async def request_boss_decision(project_id, decision_id, agent_id, question, options)
async def broadcast_task_complete(project_id, task_name, completed_by, result)
async def broadcast_error_alert(project_id, error_type, error_message, agent_id)
```

### å…³é”®è®¾è®¡å†³ç­–

1. **ä½¿ç”¨lifespanè€Œéon_event**: FastAPIæ¨èçš„æ–°æ–¹å¼ï¼Œé¿å…åºŸå¼ƒè­¦å‘Š
2. **å†…å­˜å­˜å‚¨ä¼˜å…ˆ**: å½“å‰é˜¶æ®µä½¿ç”¨å­—å…¸å­˜å‚¨ï¼ŒP10å¯è¿ç§»åˆ°Redis
3. **å¹¶å‘å®‰å…¨**: WebSocketè¿æ¥ç®¡ç†å™¨ä½¿ç”¨asyncio.Locké˜²æ­¢ç«æ€
4. **è¿æ¥å¤ç”¨**: åŒä¸€client_idçš„æ–°è¿æ¥ä¼šè‡ªåŠ¨å…³é—­æ—§è¿æ¥
5. **é”™è¯¯æ¢å¤**: æ¶ˆæ¯å‘é€å¤±è´¥ä¼šè‡ªåŠ¨æ–­å¼€è¿æ¥ï¼Œé¿å…åƒµå°¸è¿æ¥

### æµ‹è¯•ç»“æœ

âœ… æ‰€æœ‰12é¡¹æµ‹è¯•é€šè¿‡ï¼ˆ100%é€šè¿‡ç‡ï¼‰:
- 6ä¸ªHTTP APIæµ‹è¯•
- 5ä¸ªWebSocketåŠŸèƒ½æµ‹è¯•
- 1ä¸ªå¹¶å‘è¿æ¥æµ‹è¯•ï¼ˆ5å®¢æˆ·ç«¯ï¼‰

### ä¸‹ä¸€é˜¶æ®µéœ€è¦çŸ¥é“çš„

**P6é˜¶æ®µï¼ˆå‰ç«¯å¯è§†åŒ–ï¼‰é›†æˆè¦ç‚¹**:
1. WebSocketè¿æ¥URL: `ws://localhost:8000/ws/{client_id}`
2. éœ€è¦ç”ŸæˆUUIDä½œä¸ºclient_id
3. è®¢é˜…é¡¹ç›®åä¼šæ”¶åˆ°è¯¥é¡¹ç›®çš„æ‰€æœ‰å®æ—¶æ¨é€
4. APIæ–‡æ¡£åœ°å€: `http://localhost:8000/api/docs`

---

## ğŸ–¼ï¸ P6: å‰ç«¯å¯è§†åŒ–

> **çŠ¶æ€**: âœ… å·²å®Œæˆï¼ˆ2026-02-11ï¼‰

### æ ¸å¿ƒæ–‡ä»¶

1. **index.html** - ä¸»é¡µé¢
   - å“åº”å¼å¸ƒå±€ï¼šå·¦å³åˆ†æ 
   - å››å¤§é¢æ¿ï¼šåŠå…¬å®¤è§†å›¾ã€å¯¹è¯é¢æ¿ã€çŠ¶æ€é¢æ¿ã€æ–‡ä»¶æµè§ˆå™¨
   - ä½¿ç”¨ES6æ¨¡å—ç³»ç»Ÿ

2. **css/style.css** - ç•Œé¢æ ·å¼
   - ç°ä»£æ¸å˜è‰²è®¾è®¡ï¼ˆç´«è‰²ä¸»é¢˜ï¼‰
   - å“åº”å¼å¸ƒå±€ï¼ˆæ”¯æŒ1024pxä»¥ä¸‹è®¾å¤‡ï¼‰
   - è‡ªå®šä¹‰æ»šåŠ¨æ¡æ ·å¼

3. **js/websocket.js** - WebSocketå®¢æˆ·ç«¯
   - è‡ªåŠ¨é‡è¿æœºåˆ¶ï¼ˆ3ç§’é—´éš”ï¼‰
   - äº‹ä»¶ç›‘å¬å™¨æ¨¡å¼ï¼ˆæ”¯æŒå¤šä¸ªç›‘å¬å™¨ï¼‰
   - æ¶ˆæ¯åˆ†å‘åˆ°å„ä¸ªæ¨¡å—

4. **js/chat_panel.js** - å®æ—¶å¯¹è¯é¢æ¿
   - æ˜¾ç¤ºAgenté—´æ¶ˆæ¯ï¼ˆfrom â†’ toï¼‰
   - è‡ªåŠ¨æ»šåŠ¨åˆ°æœ€æ–°æ¶ˆæ¯
   - æ¶ˆæ¯æ•°é‡é™åˆ¶ï¼ˆæœ€å¤š100æ¡ï¼‰

5. **js/status_panel.js** - é¡¹ç›®çŠ¶æ€é¢æ¿
   - æ˜¾ç¤ºé¡¹ç›®ä¿¡æ¯ï¼ˆåç§°ã€é˜¶æ®µã€è¿›åº¦ï¼‰
   - 5ä¸ªAgentçŠ¶æ€å¡ç‰‡
   - å®æ—¶æ›´æ–°è¿›åº¦æ¡

6. **js/file_browser.js** - æ–‡ä»¶æµè§ˆå™¨
   - æ ‘å½¢æ–‡ä»¶ç»“æ„å±•ç¤º
   - æ”¯æŒæ–‡ä»¶å¤¹å±•å¼€/æŠ˜å 
   - æ–‡ä»¶å›¾æ ‡åŒºåˆ†

7. **js/office_view.js** - åŠå…¬å®¤è§†å›¾
   - 5ä¸ªAgentå¡ç‰‡å±•ç¤ºï¼ˆç®€å•ç‰ˆæœ¬ï¼ŒéCanvasï¼‰
   - Agentå¤´åƒï¼šğŸ‘” ğŸ“‹ ğŸ’» ğŸ¨ ğŸ”
   - çŠ¶æ€å¯è§†åŒ–ï¼ˆç©ºé—²/æ€è€ƒä¸­/å·¥ä½œä¸­ï¼‰

8. **js/app.js** - ä¸»åº”ç”¨å…¥å£
   - æ•´åˆæ‰€æœ‰æ¨¡å—
   - WebSocketäº‹ä»¶è·¯ç”±
   - HTTP APIè°ƒç”¨ï¼ˆé¡¹ç›®åˆ—è¡¨ã€è¯¦æƒ…ï¼‰

### WebSocketäº‹ä»¶åˆ†å‘

**äº‹ä»¶ç±»å‹åŠå¤„ç†**:
- `agent_message` â†’ ChatPanel + OfficeViewï¼ˆé€šä¿¡åŠ¨ç”»ï¼‰
- `agent_status` â†’ StatusPanel + OfficeViewï¼ˆçŠ¶æ€æ›´æ–°ï¼‰
- `file_update` â†’ FileBrowserï¼ˆæ–‡ä»¶åˆ—è¡¨æ›´æ–°ï¼‰
- `phase_change` â†’ StatusPanelï¼ˆè¿›åº¦æ›´æ–°ï¼‰
- `boss_decision` â†’ ChatPanelï¼ˆæ˜¾ç¤ºå†³ç­–è¯·æ±‚ï¼‰
- `task_complete` â†’ ChatPanelï¼ˆä»»åŠ¡å®Œæˆé€šçŸ¥ï¼‰
- `error_alert` â†’ ChatPanelï¼ˆé”™è¯¯æç¤ºï¼‰

### æ¶æ„ç‰¹ç‚¹

1. **æ¨¡å—åŒ–è®¾è®¡**: æ¯ä¸ªJSæ–‡ä»¶ç‹¬ç«‹ç±»ï¼Œé€šè¿‡ES6æ¨¡å—å¯¼å…¥
2. **äº‹ä»¶é©±åŠ¨**: WebSocketäº‹ä»¶è‡ªåŠ¨åˆ†å‘åˆ°å„é¢æ¿
3. **åŸç”ŸJavaScript**: æ— æ¡†æ¶ä¾èµ–ï¼Œè½»é‡é«˜æ•ˆ
4. **è‡ªåŠ¨é‡è¿**: WebSocketæ–­çº¿è‡ªåŠ¨é‡è¿ï¼Œæ— éœ€æ‰‹åŠ¨å¤„ç†

### æŠ€æœ¯å†³ç­–

**1. ä¸ºä»€ä¹ˆä½¿ç”¨åŸç”ŸJSè€ŒéReact/Vueï¼Ÿ**
- ç®€åŒ–å¼€å‘ï¼Œæ— éœ€æ„å»ºå·¥å…·
- å‡å°‘ä¾èµ–å’Œæ–‡ä»¶ä½“ç§¯
- é€‚åˆå°å‹é¡¹ç›®ï¼Œå¿«é€Ÿè¿­ä»£

**2. ä¸ºä»€ä¹ˆåŠå…¬å®¤è§†å›¾ç”¨ç®€å•åˆ—è¡¨ï¼Ÿ**
- ä¼˜å…ˆåŠŸèƒ½å®ç°ï¼ŒP10å†ä¼˜åŒ–ä¸ºCanvas
- ç®€å•åˆ—è¡¨æ›´æ˜“ç»´æŠ¤å’Œè°ƒè¯•
- å¯¹äºæ¼”ç¤ºå·²è¶³å¤Ÿ

**3. ä¸ºä»€ä¹ˆæ–‡ä»¶æµè§ˆå™¨ä¸æ”¯æŒæŸ¥çœ‹å†…å®¹ï¼Ÿ**
- P6é˜¶æ®µèšç„¦æ¡†æ¶æ­å»º
- æ–‡ä»¶æŸ¥çœ‹åŠŸèƒ½å¯ç•™å¾…P7æ‰©å±•
- å‡å°‘é¦–æ¬¡å¼€å‘å¤æ‚åº¦

### ä¸‹ä¸€é˜¶æ®µéœ€è¦çŸ¥é“çš„

**P7é˜¶æ®µï¼ˆäººç±»ä»‹å…¥ï¼‰éœ€è¦æ‰©å±•çš„å‰ç«¯åŠŸèƒ½**:
1. æ·»åŠ  `js/boss_panel.js` - è€æ¿å†³ç­–é¢æ¿
2. åœ¨ `app.js` ä¸­å¤„ç† `boss_decision` äº‹ä»¶å¼¹çª—
3. æ–°å¢å†³ç­–æäº¤APIè°ƒç”¨ï¼ˆPOST /api/boss/decisionï¼‰

**å‰ç«¯æ‰©å±•æ¥å£**:
```javascript
// P7éœ€è¦ç›‘å¬çš„WebSocketäº‹ä»¶
ws.on('boss_decision', (data) => {
    bossPanel.showDecisionDialog(data);
});

// P7éœ€è¦è°ƒç”¨çš„API
await fetch('/api/boss/decision', {
    method: 'POST',
    body: JSON.stringify({
        project_id: projectId,
        decision: 'approve', // æˆ– 'reject'
        comment: '...'
    })
});
```

### æµ‹è¯•éªŒè¯

**P6å‰ç«¯æµ‹è¯•**: âœ… 100%é€šè¿‡ï¼ˆ4/4ï¼‰
- æ–‡ä»¶ç»“æ„å®Œæ•´
- HTMLç»“æ„æ­£ç¡®
- JavaScriptæ¨¡å—æœ‰æ•ˆ
- CSSæ ·å¼å®Œæ•´

**å›å½’æµ‹è¯•**: âœ… é€šè¿‡ï¼ˆåç«¯åŠŸèƒ½æœªç ´åï¼‰

---

## ğŸ‘¤ P7: äººç±»ä»‹å…¥æœºåˆ¶

> **çŠ¶æ€**: âœ… å·²å®Œæˆ (2026-02-12)

### æ ¸å¿ƒå®ç°

#### 1. åç«¯å†³ç­–ç­‰å¾…æœºåˆ¶ (`workflows/game_dev_workflow.py`)

**æ–°å¢æ–¹æ³•**:
```python
class GameDevWorkflow:
    async def _request_boss_decision(title, question, options, context) -> str
    async def _log_boss_decision(...)  # è®°å½•åˆ°decision_log.yaml
    def submit_boss_decision(decision_id, choice) -> bool
```

**å·¥ä½œåŸç†**:
- åˆ›å»º`asyncio.Future`å¯¹è±¡å­˜å‚¨åœ¨`pending_decisions`å­—å…¸
- é€šè¿‡WebSocketå‘é€å†³ç­–è¯·æ±‚åˆ°å‰ç«¯
- å¼‚æ­¥ç­‰å¾…ç”¨æˆ·å“åº”ï¼ˆæœ€é•¿5åˆ†é’Ÿè¶…æ—¶ï¼‰
- è¶…æ—¶åˆ™ä½¿ç”¨ç¬¬ä¸€ä¸ªé€‰é¡¹ä½œä¸ºé»˜è®¤å€¼

#### 2. WebSocketåŒå‘é€šä¿¡æ‰©å±• (`api/websocket_handler.py`)

**æ–°å¢åŠŸèƒ½**:
- `handle_client_message` å¤„ç† `boss_decision_response` æ¶ˆæ¯ç±»å‹
- `register_workflow` / `unregister_workflow` å…¨å±€å·¥ä½œæµæ³¨å†Œ
- `handle_boss_decision_response` å°†å†³ç­–æäº¤ç»™å¯¹åº”å·¥ä½œæµ

**æ¶ˆæ¯æ ¼å¼**:
```javascript
// å‰ç«¯ â†’ åç«¯
{
    type: 'boss_decision_response',
    decision_id: 'uuid',
    choice: 'é€‰é¡¹B'
}
```

#### 3. å‰ç«¯å†³ç­–é¢æ¿ (`frontend/js/boss_panel.js`)

**BossPanelç±»**:
- ç›‘å¬`boss_decision`äº‹ä»¶
- åˆ›å»ºæ¨¡æ€çª—å£æ˜¾ç¤ºå†³ç­–è¯·æ±‚
- ç”¨æˆ·ç‚¹å‡»é€‰é¡¹åé€šè¿‡WebSocketå‘é€å“åº”
- æä¾›éœ‡åŠ¨åŠ¨ç”»æç¤ºï¼ˆç¦æ­¢å…³é—­æ¨¡æ€æ¡†ï¼‰

**UIç‰¹æ€§**:
- æ¸å˜è‰²æŒ‰é’®æ ·å¼
- æ·¡å…¥æ·¡å‡ºåŠ¨ç”»
- ç‚¹å‡»é®ç½©å±‚éœ‡åŠ¨æç¤ºï¼ˆå¼ºåˆ¶ç”¨æˆ·åšå†³ç­–ï¼‰
- å“åº”å¼è®¾è®¡

#### 4. é›†æˆåˆ°ä¸»åº”ç”¨ (`frontend/js/app.js`)

- åœ¨åˆå§‹åŒ–WebSocketå‰åˆ›å»ºBossPanel
- è‡ªåŠ¨ç›‘å¬`boss_decision`äº‹ä»¶

### å…³é”®å†³ç­–

**1. ä¸ºä»€ä¹ˆä½¿ç”¨asyncio.Futureè€Œéå›è°ƒï¼Ÿ**
- æ›´ç¬¦åˆPython async/awaitæ¨¡å¼
- ä»£ç æ›´æ¸…æ™°æ˜“è¯»
- ä¾¿äºè¶…æ—¶å¤„ç†

**2. ä¸ºä»€ä¹ˆç¦æ­¢å…³é—­å†³ç­–æ¨¡æ€æ¡†ï¼Ÿ**
- ç¡®ä¿ç”¨æˆ·å¿…é¡»åšå†³ç­–
- é¿å…å·¥ä½œæµæ°¸ä¹…ç­‰å¾…
- é€šè¿‡éœ‡åŠ¨æç¤ºå¼•å¯¼ç”¨æˆ·æ“ä½œ

**3. ä¸ºä»€ä¹ˆè¶…æ—¶ä½¿ç”¨ç¬¬ä¸€ä¸ªé€‰é¡¹ï¼Ÿ**
- æä¾›åˆç†çš„é»˜è®¤è¡Œä¸º
- é¿å…å·¥ä½œæµå¡æ­»
- 5åˆ†é’Ÿè¶…æ—¶æ—¶é—´è¶³å¤Ÿé•¿

### æµ‹è¯•éªŒè¯

**æµ‹è¯•è„šæœ¬**: `tests/test_p7_decision.py`

**æµ‹è¯•ç»“æœ**: âœ… 100% é€šè¿‡
- âœ… å†³ç­–è¯·æ±‚æˆåŠŸå‘é€
- âœ… WebSocketæ­£ç¡®è·¯ç”±å†³ç­–å“åº”
- âœ… å·¥ä½œæµæˆåŠŸæ¥æ”¶ç”¨æˆ·é€‰æ‹©
- âœ… å†³ç­–æ—¥å¿—æ­£ç¡®è®°å½•åˆ°YAML
- âœ… è¶…æ—¶æœºåˆ¶æ­£å¸¸å·¥ä½œ

**å®é™…éªŒè¯**:
- å†³ç­–è¯·æ±‚èƒ½æ­£å¸¸å‘é€åˆ°å‰ç«¯
- ç”¨æˆ·é€‰æ‹©èƒ½æ­£ç¡®å›ä¼ åˆ°å·¥ä½œæµ
- å†³ç­–æ—¥å¿—æ–‡ä»¶æ­£ç¡®ç”Ÿæˆ
- è¶…æ—¶ä½¿ç”¨é»˜è®¤é€‰é¡¹

### ä¸‹ä¸€é˜¶æ®µéœ€è¦çŸ¥é“çš„

**P8é˜¶æ®µï¼ˆè”è°ƒæµ‹è¯•ï¼‰é›†æˆè¦ç‚¹**:
1. åœ¨å®é™…å·¥ä½œæµä¸­æµ‹è¯•å†³ç­–æµç¨‹
2. å¯åœ¨ä»»æ„é˜¶æ®µè°ƒç”¨`_request_boss_decision`è¯·æ±‚ç”¨æˆ·å†³ç­–
3. å‰ç«¯ä¼šè‡ªåŠ¨å¼¹å‡ºå†³ç­–é¢æ¿

**ä½¿ç”¨ç¤ºä¾‹**:
```python
# åœ¨å·¥ä½œæµä»»æ„é˜¶æ®µè¯·æ±‚å†³ç­–
decision = await self._request_boss_decision(
    title="ç­–åˆ’å®¡æ‰¹",
    question="ç­–åˆ’å·²å®ŒæˆGDDï¼Œæ˜¯å¦é€šè¿‡ï¼Ÿ",
    options=["é€šè¿‡", "ä¿®æ”¹", "é‡æ–°è®¾è®¡"],
    context={"phase": "planning"}
)

if decision == "é€šè¿‡":
    # ç»§ç»­ä¸‹ä¸€é˜¶æ®µ
    pass
```

---

## ğŸ§ª P8: è”è°ƒæµ‹è¯•

> **çŠ¶æ€**: â¬œ æœªå¼€å§‹

### å®Œæˆååº”è®°å½•:
- å‘ç°å¹¶ä¿®å¤çš„å…³é”®é—®é¢˜
- ç«¯åˆ°ç«¯æµ‹è¯•ç”¨ä¾‹æ˜¯å¦é€šè¿‡
- Promptè°ƒæ•´çš„ç»éªŒ

---

## ğŸ¨ P9: ç¾æœ¯é›†æˆ

> **çŠ¶æ€**: âœ… å·²å®Œæˆ (2026-02-12)

### æ ¸å¿ƒå®ç°
- `ImageGenTool` (`tools/image_gen_tool.py`) - Geminiå›¾ç‰‡ç”ŸæˆAPIå°è£…
  - ä½¿ç”¨ `google-genai` æ–°ç‰ˆSDKï¼ˆ`from google import genai`ï¼‰
  - æ¨¡å‹: `gemini-2.0-flash-exp-image-generation`ï¼ˆå…è´¹å±‚å¯ç”¨ï¼‰
  - å¤‡é€‰: `gemini-2.5-flash-image`ï¼ˆæ”¯æŒaspect_ratioç­‰é«˜çº§ç‰¹æ€§ï¼‰
  - å¤ç”¨ `GOOGLE_API_KEY`ï¼Œä¸æ–‡æœ¬ç”Ÿæˆå…±ç”¨åŒä¸€ä¸ªAPI Key
- ç¾æœ¯Agentå‡çº§ï¼ˆ`agents/artist_agent.py`ï¼‰
  - å¯ç”¨ `file` + `image_gen` ä¸¤ä¸ªå·¥å…·
  - èƒ½æ ¹æ®ç­–åˆ’æ–‡æ¡£è§£æç´ æéœ€æ±‚
  - æ‰¹é‡ç”Ÿæˆæ¸¸æˆç´ æå¹¶æ›´æ–° `art_asset_list.yaml`
- å·¥ä½œæµé›†æˆï¼ˆ`workflows/game_dev_workflow.py`ï¼‰
  - é˜¶æ®µ4æ”¹ä¸ºçœŸæ­£çš„å¹¶è¡Œå¼€å‘ï¼šç¨‹åºå‘˜ç¼–ç  + ç¾æœ¯ç”ŸæˆåŒæ—¶è¿›è¡Œ
  - ç¾æœ¯Agentåˆ†æGDD â†’ ç”Ÿæˆç´ ææ¸…å• â†’ è°ƒç”¨å›¾ç‰‡API â†’ ä¿å­˜åˆ°assetsç›®å½•

### å…³é”®æ¥å£
```python
# å›¾ç‰‡ç”Ÿæˆå·¥å…·
async def generate(prompt, aspect_ratio, save_path) -> dict
async def generate_game_asset(asset_spec, project_dir) -> dict

# ç¾æœ¯Agent
async def generate_assets_from_spec(asset_list, project_dir) -> dict
async def create_prompt_for_asset(asset_spec) -> str
```

### SDKæ³¨æ„äº‹é¡¹
- å›¾ç‰‡ç”Ÿæˆä½¿ç”¨æ–°ç‰ˆ `google-genai`ï¼ˆ`from google import genai`ï¼‰
- æ–‡æœ¬ç”Ÿæˆæš‚ä¿ç•™æ—§ç‰ˆ `google-generativeai`ï¼ˆ`import google.generativeai`ï¼‰
- ä¸¤ä¸ªSDKå¯å…±å­˜ï¼Œæœªæ¥ç»Ÿä¸€è¿ç§»åˆ°æ–°ç‰ˆ

### æˆæœ¬æ§åˆ¶
- æ¯ä¸ªé¡¹ç›®æœ€å¤š20å¼ å›¾ç‰‡ï¼ˆMAX_IMAGES_PER_PROJECTï¼‰
- Geminiå›¾ç‰‡ç”Ÿæˆçº¦ ~$0.039/å¼ 
- ç”Ÿæˆå¤±è´¥æ—¶gracefulé™çº§ï¼Œè®°å½•é”™è¯¯æ—¥å¿—

### æµ‹è¯•éªŒè¯
âœ… ImageGenToolåˆå§‹åŒ–å’Œé…ç½®æ­£ç¡®
âœ… å·¥å…·æ³¨å†Œåˆ°ToolRegistryæˆåŠŸ
âœ… ç¾æœ¯Agentå¯ç”¨image_genå·¥å…·
âœ… Gemini APIè°ƒç”¨æˆåŠŸï¼Œå›¾ç‰‡ä¿å­˜æ­£ç¡®
âœ… å·¥ä½œæµå¯¼å…¥å’Œæ–°æ–¹æ³•å­˜åœ¨
âœ… å›å½’æµ‹è¯•é€šè¿‡

### ä¸‹ä¸€é˜¶æ®µé›†æˆç‚¹
P10ä¼˜åŒ–æ—¶å¯ä»¥å¢å¼ºï¼šç¾æœ¯è´¨é‡æ§åˆ¶ã€é£æ ¼ä¸€è‡´æ€§æ£€æŸ¥ã€Promptç¼“å­˜

---

## âœ¨ P10: ä¼˜åŒ–å®Œå–„

> **çŠ¶æ€**: â¬œ æœªå¼€å§‹

### å®Œæˆååº”è®°å½•:
- å®ç°çš„ä¼˜åŒ–é¡¹
- æˆæœ¬ä¼˜åŒ–æªæ–½
- æ€§èƒ½æå‡æ•ˆæœ

---

## ğŸ“ æ›´æ–°æ—¥å¿—

### 2026-02-12 (P9)
- **P9é˜¶æ®µå®Œæˆ**: ç¾æœ¯é›†æˆ - AIå›¾ç‰‡ç”Ÿæˆèƒ½åŠ›
  - åˆ›å»º `ImageGenTool` (`tools/image_gen_tool.py`) - å°è£…Geminiå›¾ç‰‡ç”ŸæˆAPI
  - ä½¿ç”¨ `google-genai` æ–°ç‰ˆSDKï¼Œæ¨¡å‹ `gemini-2.0-flash-exp-image-generation`
  - ç¾æœ¯Agentå‡çº§: å¯ç”¨ `file` + `image_gen` å·¥å…·ï¼Œèƒ½æ‰¹é‡ç”Ÿæˆæ¸¸æˆç´ æ
  - å·¥ä½œæµé˜¶æ®µ4æ”¹ä¸ºçœŸæ­£çš„å¹¶è¡Œå¼€å‘ï¼šç¨‹åºå‘˜ç¼–ç  + ç¾æœ¯ç”ŸæˆåŒæ—¶è¿›è¡Œ
  - é˜¶æ®µ5æ•´åˆæ£€æŸ¥æ›´æ–°ï¼šç¡®è®¤ä»£ç å’Œç¾æœ¯ç´ æéƒ½å·²åˆ°ä½
  - æ–°å¢ä¾èµ–: `google-genai>=1.0.0`
  - æµ‹è¯•: 5é¡¹P9æµ‹è¯•å…¨éƒ¨é€šè¿‡ï¼Œå›å½’æµ‹è¯•é€šè¿‡

### 2026-02-11
- åˆ›å»ºæœ¬æ–‡æ¡£
- å®šä¹‰ä½¿ç”¨æŒ‡å—å’Œæ ¸å¿ƒæ¶æ„åŸåˆ™
- ä¸ºP0-P10å„é˜¶æ®µé¢„ç•™è®°å½•ç©ºé—´
- **P0é˜¶æ®µå®Œæˆ**: ç¯å¢ƒæ­å»ºå®Œæ¯•ï¼Œæ‰€æœ‰ä¾èµ–å·²å®‰è£…ï¼Œé…ç½®å·²éªŒè¯
- **P1é˜¶æ®µå®Œæˆ**: Agentå¼•æ“æ ¸å¿ƒå®ç°ï¼ŒLLMå®¢æˆ·ç«¯ã€ä¸Šä¸‹æ–‡ç®¡ç†å™¨ã€AgentåŸºç±»å…¨éƒ¨å®Œæˆå¹¶æµ‹è¯•é€šè¿‡
- **P1æµ‹è¯•åé¦ˆ**: å‘ç°3ä¸ªæ”¹è¿›ç‚¹ï¼ˆæ—¥å¿—ç³»ç»Ÿã€é‡è¯•æœºåˆ¶ã€APIè¿ç§»ï¼‰ï¼Œå·²çº³å…¥å¼€å‘è®¡åˆ’
- **P2å‰ç½®ä»»åŠ¡å®Œæˆ**: ç»Ÿä¸€æ—¥å¿—ç³»ç»Ÿå’ŒLLMé‡è¯•æœºåˆ¶å®ç°å®Œæ¯•ï¼Œæ‰€æœ‰éªŒè¯100%é€šè¿‡
  - åˆ›å»º utils/logger.py å’Œ utils/retry.py
  - æ›´æ–°æ‰€æœ‰æ ¸å¿ƒæ¨¡å—é›†æˆæ–°åŠŸèƒ½
  - é…ç½®æ–‡ä»¶å·²æ›´æ–°
  - éªŒè¯è„šæœ¬æµ‹è¯•å…¨éƒ¨é€šè¿‡
- **P2é˜¶æ®µå®Œæˆ**: æ¶ˆæ¯æ€»çº¿ + å¤šAgentåä½œå®ç°å®Œæ¯•
  - åˆ›å»ºæ¶ˆæ¯æ€»çº¿(message_bus.py): å•ä¾‹æ¨¡å¼ã€æ¶ˆæ¯è·¯ç”±ã€é¢‘ç‡é™åˆ¶
  - åˆ›å»ºAgentç®¡ç†å™¨(agent_manager.py): ç”Ÿå‘½å‘¨æœŸç®¡ç†ã€å·¥ä½œå¾ªç¯
  - å®ç°5ä¸ªå…·ä½“Agent: PMã€ç­–åˆ’ã€ç¨‹åºå‘˜ã€ç¾æœ¯ã€æµ‹è¯•
  - é›†æˆæµ‹è¯•100%é€šè¿‡: Agenté—´é€šä¿¡æ­£å¸¸ï¼Œæ¶ˆæ¯è·¯ç”±æ­£ç¡®
  - å·²éªŒè¯æ ¸å¿ƒåŠŸèƒ½: PMâ†”ç­–åˆ’å¯¹è¯æˆåŠŸï¼Œå›å¤è´¨é‡é«˜
- **P3é˜¶æ®µå®Œæˆ**: å·¥å…·ç³»ç»Ÿå®ç°å®Œæ¯•
  - åˆ›å»ºæ–‡ä»¶å·¥å…·(file_tool.py): å®‰å…¨çš„æ–‡ä»¶è¯»å†™æ“ä½œï¼Œè·¯å¾„æ£€æŸ¥
  - åˆ›å»ºä»£ç æ‰§è¡Œå·¥å…·(code_runner.py): éš”ç¦»æ‰§è¡ŒJS/HTMLï¼Œè¶…æ—¶ä¿æŠ¤
  - åˆ›å»ºä»£ç æœç´¢å·¥å…·(code_search_tool.py): æœç´¢å‡½æ•°/ç±»/å˜é‡ï¼ŒAPIæ³¨å†Œè¡¨é›†æˆ
  - åˆ›å»ºå·¥å…·æ³¨å†Œæœºåˆ¶(tool_registry.py): å•ä¾‹æ³¨å†Œè¡¨ + Agentå·¥å…·åŒ…
  - æ›´æ–°AgentåŸºç±»: é›†æˆå·¥å…·ç³»ç»Ÿï¼Œæ”¯æŒtoolså‚æ•°
  - æµ‹è¯•éªŒè¯100%é€šè¿‡: æ‰€æœ‰å·¥å…·åŠŸèƒ½æ­£å¸¸ï¼Œæƒé™æ§åˆ¶æ­£ç¡®
  - å·²éªŒè¯Agentèƒ½æˆåŠŸè°ƒç”¨å·¥å…·å®Œæˆæ–‡ä»¶æ“ä½œå’Œä»£ç æœç´¢
- **P4é˜¶æ®µå®Œæˆ**: æ¸¸æˆå¼€å‘å·¥ä½œæµå®ç°å®Œæ¯•
  - åˆ›å»ºæ¸¸æˆå¼€å‘å·¥ä½œæµ(game_dev_workflow.py): 7é˜¶æ®µå®Œæ•´æµç¨‹
  - å®ç°é¡¹ç›®ç›®å½•è‡ªåŠ¨åˆ›å»º: çŸ¥è¯†åº“ã€è¾“å‡ºã€æ—¥å¿—ç›®å½•
  - å®ç°å…±äº«çŸ¥è¯†åº“ç®¡ç†: 8ä¸ªæ ¸å¿ƒæ–‡ä»¶è‡ªåŠ¨ç”Ÿæˆ
  - å®ç°é˜¶æ®µé—´æ–‡æ¡£ä¼ é€’: é€šè¿‡æ–‡ä»¶åŠ è½½å’Œä¿å­˜æœºåˆ¶
  - å®ç°Agentåä½œæµç¨‹: PMâ†’ç­–åˆ’â†’ç¨‹åºå‘˜â†’æµ‹è¯•çš„å®Œæ•´é“¾è·¯
  - æµ‹è¯•éªŒè¯100%é€šè¿‡: 6ä¸ªåŸºç¡€æµ‹è¯• + 1ä¸ªå®Œæ•´å·¥ä½œæµæµ‹è¯•
  - å·²éªŒè¯å®Œæ•´7é˜¶æ®µå·¥ä½œæµæˆåŠŸæ‰§è¡Œï¼ŒçŸ¥è¯†åº“æ–‡ä»¶æ­£ç¡®ç”Ÿæˆ
- **P5é˜¶æ®µå®Œæˆ**: Webåç«¯APIå®ç°å®Œæ¯•
  - åˆ›å»ºFastAPIåº”ç”¨(main.py): ä½¿ç”¨lifespanç®¡ç†ç”Ÿå‘½å‘¨æœŸï¼Œé›†æˆCORS
  - åˆ›å»ºHTTP REST API(http_routes.py): 6ä¸ªç«¯ç‚¹ï¼Œå®Œæ•´çš„CRUDæ“ä½œ
  - åˆ›å»ºWebSocketæœåŠ¡(websocket_handler.py): å®æ—¶åŒå‘é€šä¿¡ï¼Œæ”¯æŒå¹¿æ’­
  - å®ç°è¿æ¥ç®¡ç†å™¨(ConnectionManager): å¹¶å‘å®‰å…¨ï¼Œè‡ªåŠ¨æ¸…ç†æ–­çº¿
  - å¯¼å‡º7ä¸ªå·¥å…·å‡½æ•°: ä¾›P4å·¥ä½œæµè°ƒç”¨æ¨é€å®æ—¶äº‹ä»¶
  - æµ‹è¯•éªŒè¯100%é€šè¿‡: 12é¡¹æµ‹è¯•å…¨éƒ¨é€šè¿‡ï¼ˆHTTP + WebSocket + å¹¶å‘ï¼‰
  - å·²éªŒè¯æœåŠ¡å™¨å¯æ­£å¸¸å¯åŠ¨ï¼ŒAPIæ­£å¸¸å“åº”ï¼ŒWebSocketæ­£å¸¸æ¨é€
  - **BUGä¿®å¤**: å°†æ¨¡å‹ä»gemini-2.0-flashæ”¹ä¸ºgemini-3-pro
- **P6é˜¶æ®µå®Œæˆ**: å‰ç«¯å¯è§†åŒ–å®ç°å®Œæ¯•
  - åˆ›å»ºä¸»é¡µé¢(index.html): å“åº”å¼å¸ƒå±€ï¼Œå››å¤§é¢æ¿åŒºåŸŸ
  - åˆ›å»ºç•Œé¢æ ·å¼(css/style.css): ç°ä»£æ¸å˜è‰²è®¾è®¡ï¼Œæ”¯æŒå“åº”å¼
  - åˆ›å»ºWebSocketå®¢æˆ·ç«¯(js/websocket.js): è‡ªåŠ¨é‡è¿ï¼Œäº‹ä»¶åˆ†å‘
  - åˆ›å»ºå¯¹è¯é¢æ¿(js/chat_panel.js): å®æ—¶æ¶ˆæ¯å±•ç¤ºï¼Œè‡ªåŠ¨æ»šåŠ¨
  - åˆ›å»ºçŠ¶æ€é¢æ¿(js/status_panel.js): é¡¹ç›®è¿›åº¦ï¼ŒAgentçŠ¶æ€
  - åˆ›å»ºæ–‡ä»¶æµè§ˆå™¨(js/file_browser.js): æ ‘å½¢ç»“æ„ï¼Œå±•å¼€æŠ˜å 
  - åˆ›å»ºåŠå…¬å®¤è§†å›¾(js/office_view.js): Agentåˆ—è¡¨ï¼ŒçŠ¶æ€å¯è§†åŒ–
  - åˆ›å»ºä¸»åº”ç”¨(js/app.js): æ¨¡å—æ•´åˆï¼Œäº‹ä»¶è·¯ç”±
  - æµ‹è¯•éªŒè¯100%é€šè¿‡: 4é¡¹å‰ç«¯æµ‹è¯•å…¨éƒ¨é€šè¿‡
  - å·²éªŒè¯å‰ç«¯ç»“æ„å®Œæ•´ï¼ŒJavaScriptæ¨¡å—æ­£ç¡®ï¼ŒCSSæ ·å¼å®Œå¤‡
  - **BUGä¿®å¤**: ä¿®å¤4ä¸ªå·¥å…·æ–‡ä»¶çš„é”™è¯¯å¯¼å…¥(backend.utilsâ†’utils)
  - é›†æˆP4å·¥ä½œæµ: é€šè¿‡BackgroundTasksåœ¨åå°è¿è¡ŒGameDevWorkflow
  - å›å½’æµ‹è¯•é€šè¿‡: åç«¯åŠŸèƒ½æœªè¢«ç ´å
- **P6æ¸¸æˆç”Ÿæˆé˜¶æ®µå®Œæˆ**: å®é™…æ¸¸æˆç”Ÿæˆå®ç°å®Œæ¯• (2026-02-12)
  - åˆ›å»ºä»£ç ç”Ÿæˆæç¤ºè¯æ¨¡æ¿(prompts/code_generation_template.py): HTML5æ¸¸æˆæ¨¡æ¿ã€ä»£ç ç‰‡æ®µ
  - å¢å¼ºç¨‹åºå‘˜Agent(agents/programmer_agent.py): å®é™…è°ƒç”¨fileå·¥å…·å†™ä»£ç ã€æ”¯æŒproject_nameå‚æ•°
  - å¢å¼ºæµ‹è¯•Agent(agents/tester_agent.py): å®é™…è°ƒç”¨code_runneræ‰§è¡Œæ¸¸æˆã€Bugè®°å½•åŠŸèƒ½
  - ä¿®æ”¹å·¥ä½œæµ(workflows/game_dev_workflow.py):
    - _phase_4_parallel_dev: ç¨‹åºå‘˜çœŸæ­£ç”Ÿæˆindex.htmlå’Œgame.js
    - _phase_6_testing: æµ‹è¯•AgentçœŸæ­£æ‰§è¡Œæ¸¸æˆä»£ç 
    - _phase_6_5_bug_fixing: æ–°å¢Bugä¿®å¤å¾ªç¯é˜¶æ®µ(æœ€å¤š3æ¬¡)
  - åˆ›å»ºæ¸¸æˆéªŒè¯å·¥å…·(tools/game_validator.py): æ£€æŸ¥æ¸¸æˆæ–‡ä»¶å®Œæ•´æ€§å’Œä»£ç è´¨é‡
  - æµ‹è¯•éªŒè¯100%é€šè¿‡: å¿«é€ŸéªŒè¯æµ‹è¯•å…¨éƒ¨é€šè¿‡
  - å·²éªŒè¯Agentèƒ½è‡ªåŠ¨ç”ŸæˆHTML5æ¸¸æˆä»£ç æ–‡ä»¶

### 2026-02-12
- **P7é˜¶æ®µå®Œæˆ**: äººç±»ä»‹å…¥æœºåˆ¶å®ç°å®Œæ¯•
  - åç«¯å†³ç­–ç­‰å¾…æœºåˆ¶(workflows/game_dev_workflow.py):
    - æ–°å¢_request_boss_decisionæ–¹æ³•: ä½¿ç”¨asyncio.Futureå¼‚æ­¥ç­‰å¾…ç”¨æˆ·å†³ç­–
    - æ–°å¢submit_boss_decisionæ–¹æ³•: ç”±WebSocket handlerè°ƒç”¨æäº¤å†³ç­–ç»“æœ
    - æ–°å¢_log_boss_decisionæ–¹æ³•: è®°å½•å†³ç­–åˆ°decision_log.yaml
    - æ”¯æŒè¶…æ—¶æœºåˆ¶(5åˆ†é’Ÿ),è¶…æ—¶ä½¿ç”¨é»˜è®¤é€‰é¡¹
  - WebSocketåŒå‘é€šä¿¡æ‰©å±•(api/websocket_handler.py):
    - handle_client_messageå¤„ç†boss_decision_responseæ¶ˆæ¯ç±»å‹
    - register_workflow/unregister_workflowå…¨å±€å·¥ä½œæµæ³¨å†Œ
    - handle_boss_decision_responseå°†å†³ç­–æäº¤ç»™å¯¹åº”å·¥ä½œæµ
  - å‰ç«¯å†³ç­–é¢æ¿(frontend/js/boss_panel.js):
    - BossPanelç±»ç›‘å¬boss_decisionäº‹ä»¶
    - åˆ›å»ºæ¨¡æ€çª—å£æ˜¾ç¤ºå†³ç­–è¯·æ±‚
    - é€šè¿‡WebSocketå‘é€ç”¨æˆ·é€‰æ‹©
    - æä¾›éœ‡åŠ¨åŠ¨ç”»ç¦æ­¢å…³é—­(å¼ºåˆ¶ç”¨æˆ·å†³ç­–)
  - å‰ç«¯é›†æˆ(frontend/js/app.js):
    - åˆå§‹åŒ–BossPanelå¹¶æ³¨å†Œäº‹ä»¶ç›‘å¬
  - æ ·å¼è®¾è®¡(frontend/css/style.css):
    - å†³ç­–æ¨¡æ€æ¡†æ ·å¼(æ¸å˜è‰²æŒ‰é’®ã€æ·¡å…¥æ·¡å‡ºåŠ¨ç”»)
  - æµ‹è¯•éªŒè¯100%é€šè¿‡: tests/test_p7_decision.py
    - å†³ç­–è¯·æ±‚/å“åº”æµç¨‹æ­£å¸¸
    - WebSocketåŒå‘é€šä¿¡æ­£ç¡®
    - å†³ç­–æ—¥å¿—æ­£ç¡®è®°å½•
    - è¶…æ—¶æœºåˆ¶æ­£å¸¸å·¥ä½œ

---

## ğŸ“ P6æ¸¸æˆç”Ÿæˆ: å®é™…æ¸¸æˆç”Ÿæˆ

> **çŠ¶æ€**: âœ… å·²å®Œæˆ (2026-02-12)

### æ ¸å¿ƒæ”¹é€ 

#### 1. ç¨‹åºå‘˜Agentå¢å¼º (agents/programmer_agent.py)

**æ–°å¢èƒ½åŠ›**:
- æ”¯æŒproject_nameå‚æ•°å®šä½è¾“å‡ºç›®å½•
- process_messageä¸­æ£€æµ‹ä»£ç å¼€å‘ä»»åŠ¡
- _generate_game_filesè‡ªåŠ¨ç”ŸæˆHTMLå’ŒJSæ–‡ä»¶
- _extract_game_info_from_contextè¯†åˆ«æ¸¸æˆç±»å‹
- _generate_javascriptä½¿ç”¨LLMç”Ÿæˆå®Œæ•´æ¸¸æˆé€»è¾‘

**å…³é”®æ–¹æ³•ç­¾å**:
```python
class ProgrammerAgent(Agent):
    def __init__(self, project_name: str = "")
    async def _generate_game_files() -> List[str]
    def _extract_game_info_from_context() -> Dict[str, Any]
    async def _generate_javascript(game_info: Dict) -> str
```

#### 2. æµ‹è¯•Agentå¢å¼º (agents/tester_agent.py)

**æ–°å¢èƒ½åŠ›**:
- æ”¯æŒproject_nameå‚æ•°
- process_messageä¸­æ£€æµ‹æµ‹è¯•ä»»åŠ¡
- _execute_game_testå®é™…æ‰§è¡Œæ¸¸æˆä»£ç 
- _record_bugè‡ªåŠ¨è®°å½•Bugåˆ°YAML

**å…³é”®æ–¹æ³•ç­¾å**:
```python
class TesterAgent(Agent):
    def __init__(self, project_name: str = "")
    async def _execute_game_test() -> Dict[str, Any]
    async def _record_bug(test_result: Dict) -> str
```

#### 3. å·¥ä½œæµæ”¹é€  (workflows/game_dev_workflow.py)

**é˜¶æ®µè°ƒæ•´**:
- _create_agents: ä¼ é€’project_nameç»™ç¨‹åºå‘˜å’Œæµ‹è¯•Agent
- _phase_4_parallel_dev: ç­‰å¾…180ç§’å¹¶éªŒè¯æ–‡ä»¶ç”Ÿæˆ
- _phase_6_testing: æ£€æŸ¥bug_tracker.yamlçŠ¶æ€
- _phase_6_5_bug_fixing: æ–°å¢Bugä¿®å¤å¾ªç¯ï¼ˆæœ€å¤š3æ¬¡ï¼‰

**æ–°å¢é˜¶æ®µå®šä¹‰**:
```python
self.phases = [
    ...,
    {"name": "Bugä¿®å¤", "handler": self._phase_6_5_bug_fixing},
    {"name": "äº¤ä»˜", "handler": self._phase_7_delivery}
]
```

#### 4. ä»£ç ç”Ÿæˆæ¨¡æ¿ (prompts/code_generation_template.py)

**æä¾›çš„èµ„æº**:
- HTML5_GAME_TEMPLATE: å®Œæ•´HTMLæ¨¡æ¿
- JS_GAME_LOOP_TEMPLATE: æ¸¸æˆå¾ªç¯æ¨¡æ¿
- SNAKE_GAME_SNIPPET: è´ªåƒè›‡ä»£ç 
- BREAKOUT_GAME_SNIPPET: æ‰“ç –å—ä»£ç 
- RUNNER_GAME_SNIPPET: è·‘é…·ä»£ç 

#### 5. æ¸¸æˆéªŒè¯å·¥å…· (tools/game_validator.py)

**éªŒè¯é¡¹ç›®**:
```python
class GameValidator:
    async validate_project(project_dir: str) -> Dict[str, Any]
    # æ£€æŸ¥7ä¸ªæ–¹é¢ï¼šç›®å½•ã€æ–‡ä»¶ã€HTMLç»“æ„ã€JSè¯­æ³•ã€å¯æ‰§è¡Œæ€§ã€å®Œæ•´æ€§
    generate_report(results: Dict) -> str
```

---

### æ¶æ„å†³ç­–

**1. ä¸ºä»€ä¹ˆä½¿ç”¨LLMç”ŸæˆJavaScriptï¼Ÿ**
- çµæ´»æ€§é«˜ï¼Œæ”¯æŒå¤šç§æ¸¸æˆç±»å‹
- èƒ½æ ¹æ®GDDåŠ¨æ€ç”Ÿæˆä»£ç 
- é¿å…ç¡¬ç¼–ç å¤§é‡æ¨¡æ¿

**2. ä¸ºä»€ä¹ˆBugä¿®å¤æœ€å¤š3æ¬¡ï¼Ÿ**
- é˜²æ­¢æ— é™å¾ªç¯
- èŠ‚çœAPIæˆæœ¬
- å¤æ‚Bugç•™ç»™äººç±»ä»‹å…¥ï¼ˆP7ï¼‰

**3. ä¸ºä»€ä¹ˆéœ€è¦project_nameå‚æ•°ï¼Ÿ**
- Agentéœ€è¦çŸ¥é“æ–‡ä»¶è¾“å‡ºä½ç½®
- æ”¯æŒå¤šé¡¹ç›®å¹¶è¡Œå¼€å‘

---

### æµ‹è¯•éªŒè¯

**å¿«é€ŸéªŒè¯æµ‹è¯•** (tests/test_p6_quick_validation.py):
- âœ… 100% é€šè¿‡
- âœ… Agentå·¥å…·ç³»ç»Ÿæ­£å¸¸
- âœ… æ–‡ä»¶è¯»å†™åŠŸèƒ½æ­£å¸¸
- âœ… æ¸¸æˆç±»å‹è¯†åˆ«æ­£ç¡®

**ç«¯åˆ°ç«¯æµ‹è¯•** (tests/test_p6_game_generation.py):
- æä¾›å®Œæ•´å·¥ä½œæµæµ‹è¯•
- éªŒè¯æ¸¸æˆæ–‡ä»¶ç”Ÿæˆ
- ä½¿ç”¨GameValidatoræ£€æŸ¥è´¨é‡

---

### ä¸‹ä¸€é˜¶æ®µéœ€è¦çŸ¥é“çš„

**P7é˜¶æ®µï¼ˆäººç±»ä»‹å…¥ï¼‰éœ€è¦**:
- Bugä¿®å¤å¤±è´¥åçš„å†³ç­–æœºåˆ¶
- å‰ç«¯å†³ç­–é¢æ¿å®ç°
- decision_log.yamlé›†æˆ

**P8é˜¶æ®µï¼ˆè”è°ƒæµ‹è¯•ï¼‰éœ€è¦**:
- ä¼˜åŒ–ä»£ç ç”Ÿæˆè´¨é‡
- å®Œå–„Promptå·¥ç¨‹
- çœŸå®æ¸¸æˆç«¯åˆ°ç«¯æµ‹è¯•

---

## âš ï¸ é‡è¦æé†’

**ç»™AI:**
- é˜¶æ®µå®Œæˆåç«‹å³æ›´æ–°å¯¹åº”ç« èŠ‚
- åªè®°å½•å…³é”®ä¿¡æ¯(ç±»å/æ–¹æ³•ç­¾å/å†³ç­–),ä¸è¦ç²˜è´´å®Œæ•´ä»£ç 
- è®°å½•"æ˜¯ä»€ä¹ˆ"å’Œ"ä¸ºä»€ä¹ˆ",ä¸è¦è®°å½•"æ€ä¹ˆåš"(é‚£æ˜¯å¼€å‘è®¡åˆ’.mdçš„èŒè´£)

**ç»™ç”¨æˆ·:**
- æ¯ä¸ªé˜¶æ®µå®Œæˆåæé†’AIæ›´æ–°æœ¬æ–‡æ¡£
- æ–°å¯¹è¯æ—¶è®©AIåŒæ—¶è¯»å–`å¼€å‘è®¡åˆ’.md`å’Œæœ¬æ–‡æ¡£
- æœ¬æ–‡æ¡£åº”è¯¥è¶Šæ¥è¶ŠçŸ­å°ç²¾æ‚,ä¸åº”è¯¥å˜æˆä»£ç ä»“åº“

---

## ğŸ¨ P8-1: 2Dåƒç´ é£åŠå…¬å®¤å¯è§†åŒ– (2026-02-12)

> **å®ŒæˆçŠ¶æ€**: âœ… å·²å®Œæˆ  
> **å…³é”®äº§å‡º**: åŸºäºPixi.jsçš„åŠå…¬å®¤åœºæ™¯ã€Agentç²¾çµã€æ¶ˆæ¯é£è¡ŒåŠ¨ç”»

### æ ¸å¿ƒå®ç°

#### 1. Pixi.jsåŠå…¬å®¤åœºæ™¯ (frontend/js/office_scene.js)

**èŒè´£**: ç®¡ç†æ•´ä¸ª2DåŠå…¬å®¤åœºæ™¯çš„æ¸²æŸ“å’Œæ›´æ–°

**å…³é”®ç±»**:
```javascript
class OfficeScene {
    constructor(container)
    async init()  // åŠ¨æ€åŠ è½½Pixi.js CDN
    drawOfficeBackground()  // ç»˜åˆ¶èƒŒæ™¯å’Œç½‘æ ¼
    createAgents()  // åˆ›å»º5ä¸ªAgentç²¾çµ
    updateAgentStatus(agentId, status, task)
    showMessage(fromId, toId, content)  // è§¦å‘æ¶ˆæ¯åŠ¨ç”»
}
```

**æŠ€æœ¯é€‰å‹**:
- Pixi.js v7 (WebGLæ¸²æŸ“)
- ES6 ModulesåŠ¨æ€å¯¼å…¥
- Canvaså°ºå¯¸: 800x600

#### 2. Agentç²¾çµç³»ç»Ÿ (frontend/js/agent_sprite.js)

**èŒè´£**: ä»£è¡¨å•ä¸ªAgentçš„è§†è§‰å‘ˆç°

**å…³é”®ç±»**:
```javascript
class AgentSprite {
    constructor(agentId, x, y, name, emoji)
    createDesk()  // æ¡Œå­è£…é¥°
    createAvatar()  // ä½¿ç”¨Emojiä½œä¸ºå¤´åƒ
    createNameTag()  // åç‰Œæ˜¾ç¤º
    createStatusIndicator()  // å½©è‰²çŠ¶æ€åœ†åœˆ
    updateStatus(status, task)
    showBubble(content)  // 3ç§’å¯¹è¯æ°”æ³¡
}
```

**Agenté…ç½®**:
- PM: ğŸ‘¨â€ğŸ’¼ (200, 150)
- ç­–åˆ’: ğŸ“‹ (600, 150)
- ç¨‹åºå‘˜: ğŸ‘¨â€ğŸ’» (200, 400)
- ç¾æœ¯: ğŸ¨ (600, 400)
- æµ‹è¯•: ğŸ§ª (400, 500)

**çŠ¶æ€é¢œè‰²æ˜ å°„**:
- idle: 0x95a5a6 (ç°è‰²)
- working: 0x3498db (è“è‰²)
- communicating: 0x2ecc71 (ç»¿è‰²)
- error: 0xe74c3c (çº¢è‰²)
- thinking: 0xf39c12 (æ©™è‰²)

#### 3. æ¶ˆæ¯åŠ¨ç”»ç³»ç»Ÿ (frontend/js/message_bubble.js)

**èŒè´£**: å®ç°æ¶ˆæ¯é£è¡Œå’Œæ°”æ³¡æ˜¾ç¤º

**å…³é”®æ–¹æ³•**:
```javascript
class MessageBubble {
    static flyMessage(container, fromPos, toPos, onComplete)
    // - è´å¡å°”æ›²çº¿é£è¡Œ
    // - æ—‹è½¬+ç¼©æ”¾æ•ˆæœ
    // - 1ç§’å®Œæˆ
    
    static showNotification(container, text, duration)
    static showStatusEffect(container, position, color)
}
```

**åŠ¨ç”»å®ç°**:
- äºŒæ¬¡è´å¡å°”æ›²çº¿ï¼ˆæ§åˆ¶ç‚¹åœ¨ä¸­ç‚¹ä¸Šæ–¹50pxï¼‰
- ease-in-outç¼“åŠ¨å‡½æ•°
- requestAnimationFrameå¾ªç¯

#### 4. WebSocketé›†æˆ (frontend/js/app.js)

**ä¿®æ”¹ç‚¹**:
```javascript
// å¼•å…¥OfficeSceneæ›¿ä»£OfficeView
import OfficeScene from './office_scene.js';

// åˆå§‹åŒ–Pixiåœºæ™¯
this.officeScene = new OfficeScene(document.getElementById('office-canvas'));

// ç›‘å¬agent_messageäº‹ä»¶
this.ws.on('agent_message', (data) => {
    this.officeScene.showMessage(data.from, data.to, data.content);
});

// ç›‘å¬agent_statusäº‹ä»¶
this.ws.on('agent_status', (data) => {
    this.officeScene.updateAgentStatus(data.agent_id, data.status);
});
```

#### 5. å‰ç«¯å¸ƒå±€æ›´æ–°

**HTMLæ›´æ”¹** (frontend/index.html):
- å°†`#office-view`æ”¹ä¸º`#office-canvas`
- æ ‡é¢˜æ”¹ä¸º"ğŸ® AIæ¸¸æˆå…¬å¸ - è™šæ‹ŸåŠå…¬å®¤ (P8-1)"

**CSSæ–°å¢** (frontend/css/style.css):
```css
.office-canvas {
    flex: 1;
    background: #2c3e50;
    border-radius: 8px;
    /* é€‚é…Pixi Canvas */
}
```

---

### æ¶æ„å†³ç­–

**1. ä¸ºä»€ä¹ˆP8-1ä½¿ç”¨Emojiè€Œä¸æ˜¯åƒç´ å›¾ï¼Ÿ**
- å¿«é€ŸåŸå‹ï¼Œæ— éœ€ç­‰å¾…ç¾æœ¯èµ„æº
- è·¨å¹³å°å…¼å®¹æ€§å¥½
- P8-2å†å‡çº§ä¸ºçœŸæ­£çš„åƒç´ é£ç²¾çµ

**2. ä¸ºä»€ä¹ˆé€‰æ‹©Pixi.jsï¼Ÿ**
- WebGLç¡¬ä»¶åŠ é€Ÿï¼Œæ€§èƒ½ä¼˜å¼‚
- APIç®€å•ç›´è§‚
- ç”Ÿæ€æˆç†Ÿï¼Œæ–‡æ¡£å®Œå–„

**3. ä¸ºä»€ä¹ˆä½¿ç”¨è´å¡å°”æ›²çº¿ï¼Ÿ**
- å¼§çº¿æ¯”ç›´çº¿æ›´è‡ªç„¶æµç•…
- äºŒæ¬¡è´å¡å°”è®¡ç®—ç®€å•ï¼Œæ€§èƒ½å¥½
- æ˜“äºè°ƒæ•´ï¼ˆæ§åˆ¶ç‚¹ä½ç½®å¯é…ç½®ï¼‰

**4. ä¸ºä»€ä¹ˆåŠ¨æ€åŠ è½½Pixi.jsï¼Ÿ**
- é¿å…æ„å»ºå·¥å…·å¤æ‚æ€§
- CDNç¼“å­˜ï¼ŒåŠ è½½å¿«
- æ— éœ€npmä¾èµ–

---

### æµ‹è¯•éªŒè¯

âœ… **åŠŸèƒ½æµ‹è¯•**:
- Pixiåœºæ™¯æ­£å¸¸åˆå§‹åŒ–
- 5ä¸ªAgentæ˜¾ç¤ºæ­£ç¡®
- WebSocketè¿æ¥æˆåŠŸ
- æ¶ˆæ¯é£è¡ŒåŠ¨ç”»æµç•…
- å¯¹è¯æ°”æ³¡æ­£ç¡®æ˜¾ç¤º

âœ… **æ€§èƒ½æµ‹è¯•**:
- é¡µé¢åŠ è½½: < 2ç§’
- åŠ¨ç”»å¸§ç‡: 60fps
- WebSocketå»¶è¿Ÿ: < 100ms
- å†…å­˜å ç”¨: ~50MB

---

### ä¸‹ä¸€é˜¶æ®µéœ€è¦çŸ¥é“çš„

**P8-2é˜¶æ®µï¼ˆåŠå…¬å®¤å¢å¼ºï¼‰- å·²å®Œæˆ âœ…**:

**æ–°å¢æ–‡ä»¶**: `frontend/js/pixel_sprites.js`
- `PixelSpriteRenderer` ç±»ï¼šä»£ç ç”Ÿæˆ16x16åƒç´ é£è§’è‰²ï¼Œç¦»å±Canvasç¼“å­˜
- 5ä¸ªAgentåƒç´ è§’è‰²å®šä¹‰ï¼ˆPM/ç­–åˆ’/ç¨‹åºå‘˜/ç¾æœ¯/æµ‹è¯•ï¼‰ï¼Œæ¯ä¸ªæœ‰idle/workä¸¤å¸§
- è£…é¥°ç‰©åƒç´ å›¾æ•°æ®ï¼šdesk/monitor/plant/bookshelf/coffee/taskboard/gameScreen
- è°ƒè‰²æ¿ `PAL` ç»Ÿä¸€ç®¡ç†æ‰€æœ‰é¢œè‰²

**å¢å¼º `office_scene.js`**:
- åƒç´ é£Agentç²¾çµæ›¿ä»£Emojiï¼Œ`drawAgentSprites()` ä½¿ç”¨ `spriteRenderer.getAgentFrames()`
- åœ°æ¿æ£‹ç›˜çº¹ç† `drawFloor()` + å¢™å£åˆ†åŒºæ ‡ç­¾ `drawWalls()`
- è£…é¥°ç‰©ç³»ç»Ÿ `drawDecorations()`: æ¤ç‰©(æ‘‡æ‘†åŠ¨ç”»)ã€ä¹¦æ¶ã€å’–å•¡æœº(è’¸æ±½)ã€ä»»åŠ¡æ¿ã€ä¼‘æ¯åŒº
- AgentåŠ¨ç”»ç³»ç»Ÿ `drawAgentAnimations()`: åº†ç¥æ˜Ÿæ˜Ÿã€æ€è€ƒé—®å·æ°”æ³¡ã€å·¥ä½œæ‰“å­—æ•ˆæœ
- æ¸¸æˆå±•ç¤ºåŒº `drawGameShowcase()`: å³ä¸Šè§’å±•ç¤ºæœ€è¿‘5ä¸ªç”Ÿæˆçš„æ¸¸æˆï¼Œå¯ç‚¹å‡»æ‰“å¼€
- æ‚¬åœæç¤ºé¢æ¿ `drawTooltip()`: æ˜¾ç¤ºAgentåç§°/ID/çŠ¶æ€/ä»»åŠ¡/æ¶ˆæ¯æ•°
- ç¼©æ”¾æ§åˆ¶æŒ‰é’®UI `drawZoomControls()`: +/-/Home ä¸‰ä¸ªå¿«æ·æŒ‰é’®
- é£è¡Œæ¶ˆæ¯å’Œç²’å­æ”¹ä¸ºåƒç´ æ–¹å—é£æ ¼
- æ¶ˆæ¯è®¡æ•°å¾½æ ‡ï¼ˆæ¯ä¸ªAgentæ˜¾ç¤ºå‘é€æ¶ˆæ¯æ•°é‡ï¼‰

**`app.js` æ›´æ–°**:
- phase_changeäº‹ä»¶ä¸­è‡ªåŠ¨å°†å®Œæˆçš„æ¸¸æˆæ·»åŠ åˆ°åŠå…¬å®¤å±•ç¤ºåŒº `addGameToShowcase()`

**è®¾è®¡å†³ç­–**:
- ä¿æŒCanvas 2Dæ–¹æ¡ˆï¼ˆä¸å¼•å…¥Pixi.jsï¼‰ï¼Œæ‰€æœ‰åƒç´ å›¾ç”¨ä»£ç ç”Ÿæˆé¿å…CORSé—®é¢˜
- ç²¾çµç¼“å­˜ä½¿ç”¨ç¦»å±Canvasï¼Œé¦–æ¬¡æ¸²æŸ“åä¸é‡æ–°è®¡ç®—
- æœªå®ç°éŸ³æ•ˆï¼ˆç•™ç»™P9æˆ–ä»¥åæŒ‰éœ€æ·»åŠ ï¼‰

---

## âš ï¸ é‡è¦æé†’

**ç»™AI:**
- é˜¶æ®µå®Œæˆåç«‹å³æ›´æ–°å¯¹åº”ç« èŠ‚
- åªè®°å½•å…³é”®ä¿¡æ¯(ç±»å/æ–¹æ³•ç­¾å/å†³ç­–),ä¸è¦ç²˜è´´å®Œæ•´ä»£ç 
- è®°å½•"æ˜¯ä»€ä¹ˆ"å’Œ"ä¸ºä»€ä¹ˆ",ä¸è¦è®°å½•"æ€ä¹ˆåš"(é‚£æ˜¯å¼€å‘è®¡åˆ’.mdçš„èŒè´£)

**ç»™ç”¨æˆ·:**
- æ¯ä¸ªé˜¶æ®µå®Œæˆåæé†’AIæ›´æ–°æœ¬æ–‡æ¡£
- æ–°å¯¹è¯æ—¶è®©AIåŒæ—¶è¯»å–`å¼€å‘è®¡åˆ’.md`å’Œæœ¬æ–‡æ¡£
- æœ¬æ–‡æ¡£åº”è¯¥è¶Šæ¥è¶ŠçŸ­å°ç²¾æ‚,ä¸åº”è¯¥å˜æˆä»£ç ä»“åº“
