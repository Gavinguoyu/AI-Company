# P{X} 阶段开发指引

> **阶段名称**: P{X} - {阶段名称}  
> **预计复杂度**: {低/中/高}  
> **文档级别**: Level {1/2/3}  
> **使用说明**: AI开始新阶段开发时，只需阅读本文档 + platform_constitution.md

---

## 🎯 阶段目标

{简要描述本阶段要实现的核心目标，3-5句话}

---

## 📋 核心任务清单

### 必须完成的功能

- [ ] **任务1**: {功能描述}
  - 文件: `{文件路径}`
  - 关键类/函数: `{名称}`
  
- [ ] **任务2**: {功能描述}
  - 文件: `{文件路径}`
  - 关键类/函数: `{名称}`

- [ ] **任务3**: {功能描述}
  - 文件: `{文件路径}`
  - 关键类/函数: `{名称}`

### 可选功能（时间充裕时）

- [ ] {可选功能1}
- [ ] {可选功能2}

---

## 🔗 前置依赖

### P{X-1}阶段已提供的接口

**已实现的类**:
- `ClassName1` - {职责描述}
  - `method1(params) -> return` - {功能}
  - `method2(params) -> return` - {功能}

**可以直接使用**:
- 消息格式: {参考platform_constitution.md中的标准}
- 工具调用: {已有的工具列表}
- 配置项: {可用的配置}

**重要约束**:
- 约束1: {描述}
- 约束2: {描述}

---

## ✅ 验证标准

### 功能验证
- [ ] {验证项1}
- [ ] {验证项2}
- [ ] {验证项3}

### 集成验证
- [ ] 与P{X-1}的集成正常
- [ ] 不破坏已有功能（回归测试通过）

### 质量标准
- [ ] 代码符合项目规范（见platform_constitution.md核心原则）
- [ ] 所有异步操作使用async/await
- [ ] 完善的错误处理和日志记录

---

## 🛠️ 推荐使用的Skills

本阶段推荐激活以下Cursor Skills：
- `{skill-name-1}` - {用途}
- `{skill-name-2}` - {用途}
- `{skill-name-3}` - {用途}

---

## 📐 技术要点

### 关键技术点1
{描述和注意事项}

### 关键技术点2
{描述和注意事项}

### 需要注意的坑
- ⚠️ {常见问题1}
- ⚠️ {常见问题2}

---

## 🧪 测试方案（自动执行）

**本阶段完成后，AI将自动：**

### Step 1: 快速回归测试
```bash
python tests/run_regression.py
```
- 验证P{X-1}之前的功能未被破坏
- 只测关键入口点，不深入测试

### Step 2: 生成P{X}测试脚本
- AI按照 `docs/templates/test_template.md` 生成 `test_p{X}.py`
- 只测试本阶段新增的功能
- 测试覆盖：初始化、核心功能、集成点

### Step 3: 执行测试（用户运行）
```bash
python test_p{X}.py
```

### Step 4: 记录结果
- 测试通过 → AI更新platform_constitution.md
- 测试失败 → AI分析错误并修复

---

## 📝 完成后的文档工作（自动执行）

**本阶段完成后，AI将自动：**

### 1. 更新 platform_constitution.md（必做）
- 在P{X}章节记录：
  - 实现的核心类和接口
  - 关键方法签名
  - 下一阶段需要知道的集成点
  - 设计决策和理由

### 2. 生成阶段报告（按级别）
- **Level 1** (P7, P9): 不生成报告，只更新constitution
- **Level 2** (P5, P6, P10): 生成精简报告（150-200行）
- **Level 3** (P8): 生成详细报告（400-500行）

**本阶段文档级别**: Level {X}

### 3. 报告模板
- 如需生成报告，按照 `docs/templates/report_template.md`
- 只包含5个核心章节，删除冗余内容

---

## 🚀 下一阶段预告

**P{X+1}阶段将实现**: {简要描述}

**本阶段需要为P{X+1}准备**:
- 提供接口: {接口列表}
- 输出文件: {文件列表}
- 文档更新: {必须记录的内容}

---

## 💡 开发提示

### 时间分配建议
- 代码实现: 60%
- 测试调试: 25%
- 文档更新: 15%

### 常见问题FAQ
Q: {问题1}
A: {答案1}

Q: {问题2}
A: {答案2}

---

**指引版本**: v1.0  
**最后更新**: {日期}  
**预计工作量**: {X-Y}轮对话
